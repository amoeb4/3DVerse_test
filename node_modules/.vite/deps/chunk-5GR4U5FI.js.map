{
  "version": 3,
  "sources": ["../../@3dverse/livelink-react/sources/hooks/useEntity.ts", "../../@3dverse/livelink-react/sources/components/core/Livelink.tsx", "../../@3dverse/livelink-react/sources/hooks/useClients.ts", "../../@3dverse/livelink-react/sources/hooks/useCameraEntity.ts", "../../@3dverse/livelink-react/sources/components/core/Canvas.tsx", "../../@3dverse/livelink-react/sources/components/core/Viewport.tsx", "../../@3dverse/livelink-react/sources/components/core/CameraController.tsx", "../../@3dverse/livelink-react/sources/components/utils/Recorder.tsx", "../../@3dverse/livelink-react/sources/index.ts", "../../@3dverse/livelink-react/sources/components/overlays/DOM3DOverlay.tsx", "../../@3dverse/livelink-react/sources/overlays/React3DElement.tsx", "../../@3dverse/node_modules/gl-matrix/esm/common.js", "../../@3dverse/node_modules/gl-matrix/esm/vec3.js", "../../@3dverse/livelink-react/sources/overlays/ReactOverlay.ts", "../../@3dverse/livelink-react/sources/components/overlays/DOM3DElement.tsx", "../../@3dverse/livelink-react/sources/components/overlays/DOMEntity.tsx"],
  "sourcesContent": ["//------------------------------------------------------------------------------\nimport { useContext, useEffect, useReducer, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport type {\n    Entity,\n    EntityCreationOptions,\n    ComponentsManifest,\n    FindEntityQuery,\n    UUID,\n    ComponentName,\n    EntityUpdatedEvent,\n} from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"../components/core/Livelink\";\n\n/**\n * An new entity instance.\n *\n * @inline\n */\ntype NewEntity = {\n    /**\n     * The name of the entity.\n     */\n    name: string;\n\n    /**\n     * The components to attach to the entity with their initial values.\n     */\n    components: ComponentsManifest;\n\n    /**\n     * The creation options of the entity.\n     */\n    options: EntityCreationOptions;\n};\n\n/**\n * @inline\n */\ntype FindEntityQueryByNames = {\n    /**\n     * The names of the entities to find.\n     */\n    names: Array<string>;\n};\n\n/**\n * @inline\n */\ntype FindEntityQueryByName = {\n    /**\n     * The name of the entity to find.\n     */\n    name: string;\n};\n\n/**\n * A provider of an entity.\n */\ntype EntityProvider = NewEntity | FindEntityQueryByName | Exclude<FindEntityQuery, FindEntityQueryByNames>;\n\n/**\n * A hook that provides an entity and a flag indicating if the entity is pending loading.\n *\n * @example\n * ```tsx\n * const { isPending, entity } = useEntity({ id: \"00000000-0000-0000-0000-000000000000\" });\n * if (isPending) {\n *     return <div>Loading...</div>;\n * }\n * if (!entity) {\n *     return <div>Entity not found</div>;\n * }\n * return <div>Entity found: {entity.name}</div>;\n * ```\n * @param entityProvider - The entity provider.\n * @returns The entity and a flag indicating if the entity is pending loading.\n *\n * @category Hooks\n */\nexport function useEntity(\n    entityProvider: EntityProvider,\n    watchedComponents: Array<ComponentName> | \"any\" = [],\n): {\n    isPending: boolean;\n    entity: Entity | null;\n} {\n    const { instance } = useContext(LivelinkContext);\n\n    const [entity, setEntity] = useState<Entity | null>(null);\n    const [isPending, setIsPending] = useState(true);\n    const [, forceUpdate] = useReducer(x => x + 1, 0);\n\n    const findEntityQuery = entityProvider as {\n        euid?: UUID;\n        linkage?: Array<UUID>;\n        name?: string;\n        mandatory_components?: Array<ComponentName>;\n        forbidden_components?: Array<ComponentName>;\n    };\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        const resolveEntity = async (): Promise<Entity | null> => {\n            if (\"components\" in entityProvider) {\n                console.debug(\"---- Creating entity\");\n                return await instance.scene.newEntity(entityProvider);\n            } else if (\"linkage\" in findEntityQuery) {\n                return await instance.scene.findEntity({\n                    entity_uuid: findEntityQuery.euid!,\n                    linkage: findEntityQuery.linkage,\n                });\n            } else if (\"euid\" in findEntityQuery) {\n                return (await instance.scene.findEntities({ entity_uuid: findEntityQuery.euid! }))[0];\n            } else if (\"name\" in findEntityQuery && findEntityQuery.name) {\n                return (await instance.scene.findEntitiesByNames({ entity_names: [findEntityQuery.name] }))[0];\n            } else if (\"mandatory_components\" in findEntityQuery) {\n                return (\n                    await instance.scene.findEntitiesWithComponents({\n                        mandatory_components: findEntityQuery.mandatory_components!,\n                        forbidden_components: findEntityQuery.forbidden_components,\n                    })\n                )[0];\n            }\n            return null;\n        };\n\n        resolveEntity()\n            .then(foundEntity => setEntity(foundEntity))\n            .finally(() => setIsPending(false));\n\n        return (): void => {\n            setEntity(null);\n            setIsPending(true);\n        };\n    }, [instance, JSON.stringify(findEntityQuery)]);\n\n    useEffect(() => {\n        const alwaysUpdate = watchedComponents === \"any\";\n        const neverUpdate = watchedComponents.length === 0;\n\n        if (!entity || neverUpdate) {\n            return;\n        }\n\n        const triggerUpdate = alwaysUpdate\n            ? forceUpdate\n            : (event: EntityUpdatedEvent): void => {\n                  if (event.isAnyComponentDirty({ components: watchedComponents })) {\n                      forceUpdate();\n                  }\n              };\n\n        entity.addEventListener(\"on-entity-updated\", triggerUpdate);\n\n        return (): void => {\n            entity.removeEventListener(\"on-entity-updated\", triggerUpdate);\n        };\n    }, [entity, watchedComponents]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if(!entity) {\n            return;\n        }\n\n        entity.addEventListener(\"on-entity-visibility-changed\", forceUpdate);\n        return (): void => {\n            entity.removeEventListener(\"on-entity-visibility-changed\", forceUpdate);\n        };\n    }, [entity]);\n\n    return { isPending, entity };\n}\n", "//------------------------------------------------------------------------------\nimport React, { createContext, JSX, PropsWithChildren, useCallback, useEffect, useRef, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport * as Livelink from \"@3dverse/livelink\";\nimport { Livelink as LivelinkInstance, type UUID } from \"@3dverse/livelink\";\nimport { StrictUnion } from \"../../utils\";\n\n/**\n * Context for managing the Livelink connection state.\n *\n * Provides information about the current Livelink instance, connection status,\n * and a method to disconnect from the Livelink service.\n *\n * @category Contexts\n */\nexport const LivelinkContext = createContext<{\n    /** The current Livelink instance or `null` if not connected. */\n    instance: LivelinkInstance | null;\n\n    /** Indicates whether the connection is currently in progress. */\n    isConnecting: boolean;\n\n    /** Indicates whether the connection has been disconnected. */\n    isDisconnected: boolean;\n\n    /** Function to disconnect from the current Livelink session. */\n    disconnect: () => void;\n}>({\n    instance: null,\n    isConnecting: false,\n    isDisconnected: false,\n    disconnect: () => {},\n});\n\n/**\n * Represents the mode for joining an existing session.\n *\n * @inline\n */\nexport type SessionJoinMode = {\n    /**\n     * The UUID of the session to join.\n     */\n    sessionId: UUID;\n};\n\n/**\n * Represents the mode for either joining or starting a session.\n *\n * @inline\n */\nexport type SessionJoinOrStart = {\n    /**\n     * The UUID of the scene to connect to or start a session on.\n     */\n    sceneId: UUID;\n\n    /**\n     * Whether to automatically join any existing session.\n     */\n    autoJoinExisting?: boolean;\n\n    /**\n     * If a new session is started, specifies whether it is transient (non-persistent).\n     * If a session is joined, this property is ignored.\n     */\n    isTransient?: boolean;\n};\n\n/**\n * Represents the mode for joining an existing session as a guest user.\n *\n * @inline\n */\nexport type SessionJoinGuest = {\n    /**\n     * The authentication type for the guest client.\n     */\n    clientType: \"guest\";\n};\n\n/**\n * Represents the union of all possible session open modes.\n *\n * This type includes:\n * - `SessionJoinMode`: For joining an existing session.\n * - `SessionJoinOrStart`: For joining or starting a session based on the provided context.\n *\n * @inline\n */\nexport type SessionOpenMode = StrictUnion<SessionJoinMode | SessionJoinOrStart | SessionJoinGuest>;\n\n/**\n * Parameters for establishing a Livelink connection.\n *\n * Extends `SessionOpenMode` to define the session behavior and includes additional\n * options for handling connection lifecycle events, UI components, and settings.\n *\n * @inline\n * @category Components\n */\nexport type LivelinkConnectParameters = {\n    /**\n     * Authentication token required to establish the connection.\n     */\n    token: string;\n\n    /**\n     * Optional React component or node displayed while the connection is loading.\n     */\n    LoadingPanel?: React.ComponentType<{ stage: string }>;\n\n    /**\n     * Optional React component or node displayed when an inactivity timeout occurs.\n     */\n    InactivityWarningPanel?: React.ComponentType<{ warningDuration: number; onActivityDetected: () => void }>;\n\n    /**\n     * Optional React component or node displayed when the connection is disconnected.\n     */\n    ConnectionErrorPanel?: React.ComponentType<{ error: string }>;\n} & SessionOpenMode;\n\n/**\n * Connection promises map.\n *\n * To deal with React strict mode, and avoiding to create a session multiple times,\n * we need to keep track of the connection promises. The promises are stored\n * using the connection parameters as key.\n *\n * @internal\n */\ntype ConnectionPromisesMap = Map<string, Promise<Livelink.Livelink>>;\n\n/**\n * Provides the Livelink context and manages the lifecycle of a Livelink connection.\n *\n * This component initializes and maintains a connection to the Livelink service\n * and supplies relevant connection state and methods to its children via context.\n *\n * @param params\n *\n * @param params.children - React children components that will have access to the Livelink context.\n * @param params.sceneId - The unique identifier of the scene to connect to (required for \"start\" or \"join-or-start\").\n * @param params.sessionId - The unique identifier of the session to join (required for \"join\").\n * @param params.isTransient - Specifies if the connection is transient (non-persistent).\n * @param params.token - The authentication token required for the Livelink connection.\n * @param params.LoadingPanel - Optional React node displayed while the connection is being established.\n * @param params.InactivityWarningPanel - Optional React node displayed when an inactivity timeout occurs.\n * @param params.ConnectionErrorPanel - Optional React node displayed when the connection is lost.\n * @param params.autoJoinExisting - Specifies the mode for opening the session; defaults to `\"join-or-start\"`.\n *\n * @category Components\n */\nexport function LivelinkProvider({\n    sceneId,\n    sessionId,\n    isTransient,\n    token,\n    LoadingPanel,\n    InactivityWarningPanel,\n    ConnectionErrorPanel,\n    autoJoinExisting = true,\n    clientType,\n    children,\n}: PropsWithChildren<LivelinkConnectParameters>): JSX.Element {\n    const [instance, setInstance] = useState<LivelinkInstance | null>(null);\n    const [isConnecting, setIsConnecting] = useState(true);\n    const [isConnectionLost, setIsConnectionLost] = useState(false);\n    const [inactivityWarning, setInactivityWarning] = useState<Livelink.InactivityWarningEvent | null>(null);\n    const [connectionError, setConnectionError] = useState<string>(\"Unknown error\");\n    const connectionPromises = useRef<ConnectionPromisesMap>(new Map());\n\n    const disconnect = useCallback(() => instance?.disconnect(), [instance]);\n\n    useEffect(() => {\n        const connect = async ({\n            autoJoinExisting,\n            sceneId,\n            sessionId,\n            clientType,\n        }: SessionOpenMode): Promise<Livelink.Livelink> => {\n            if (sessionId) {\n                const session = await Livelink.Session.findById({ session_id: sessionId, token });\n                if (!session) {\n                    throw new Error(`Session '${sessionId}' not found on scene '${sceneId}'`);\n                }\n                return LivelinkInstance.join({ session });\n            }\n\n            if (sceneId) {\n                if (autoJoinExisting) {\n                    return LivelinkInstance.join_or_start({ scene_id: sceneId, token, is_transient: isTransient });\n                } else {\n                    return LivelinkInstance.start({ scene_id: sceneId, token, is_transient: isTransient });\n                }\n            }\n\n            if (clientType === \"guest\") {\n                const session = await Livelink.Session.findByGuestToken({ guest_token: token });\n                if (!session) {\n                    throw new Error(`No session available for guest token '${token}'`);\n                }\n\n                return LivelinkInstance.join({ session });\n            }\n\n            throw new Error(\"What are we doing here?!\");\n        };\n\n        /**\n         * To deal with React strict mode, and avoiding to create a session multiple times,\n         * we need to keep track of the connection promises. The promises are stored\n         * using the connection parameters as key.\n         *\n         * @returns The connection promise for the given parameters.\n         */\n        const getOrCreateConnectionPromise = (params: LivelinkConnectParameters): Promise<Livelink.Livelink> => {\n            const key = getConnectionPromiseKey(params);\n            let promise = connectionPromises.current.get(key);\n            if (!promise) {\n                promise = connect(params).then(instance => {\n                    connectionPromises.current.delete(key);\n                    return instance;\n                });\n                connectionPromises.current.set(key, promise);\n            }\n            return promise;\n        };\n\n        /**\n         * Abort controller to avoid side effects when the component is unmounted.\n         */\n        const abort_controller = new AbortController();\n\n        const onActivityDetected = (): void => {\n            setInactivityWarning(null);\n        };\n\n        getOrCreateConnectionPromise({\n            autoJoinExisting,\n            sceneId,\n            sessionId,\n            token,\n            clientType,\n        } as LivelinkConnectParameters)\n            .then(instance => {\n                // if the component is unmounted, stop right here, and do not proceed with the connection\n                if (abort_controller.signal.aborted) {\n                    return;\n                }\n\n                console.debug(\"Connected to Livelink\", instance);\n                configureClient(instance);\n                setInstance(instance);\n                instance.TO_REMOVE__setReadyCallback(async () => {\n                    instance.startStreaming();\n                    setIsConnecting(false);\n                });\n\n                instance.session.addEventListener(\"on-inactivity-warning\", setInactivityWarning);\n                instance.session.addEventListener(\"on-activity-detected\", onActivityDetected);\n            })\n            .catch(error => {\n                console.debug(\"Failed to connect to Livelink\", error);\n                setIsConnecting(false);\n                setIsConnectionLost(true);\n                setConnectionError(error);\n            });\n\n        return (): void => {\n            abort_controller.abort();\n\n            instance?.session.removeEventListener(\"on-inactivity-warning\", setInactivityWarning);\n            instance?.session.removeEventListener(\"on-activity-detected\", onActivityDetected);\n\n            setInstance(null);\n            setIsConnecting(true);\n            setIsConnectionLost(false);\n            setInactivityWarning(null);\n        };\n    }, [token, autoJoinExisting, sceneId, sessionId, isTransient, clientType]);\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        // Allow the hook user to be notified of a disconnection occuring while the above operations run.\n        // Still not perfect, because the gateway might disconnect before the instance is returned during\n        // the GatewayController.authenticateClient or EditorController.connectToSession of livelink-core.\n        // Also nothing's notify the livelink user of a loss of the EditorConnection.\n\n        const onDisconnectedHandler = (event: Livelink.DisconnectedEvent): void => {\n            setIsConnectionLost(true);\n            setInactivityWarning(null);\n            setConnectionError(event.reason);\n        };\n\n        instance.session.addEventListener(\"on-disconnected\", onDisconnectedHandler);\n\n        return (): void => {\n            instance.session.removeEventListener(\"on-disconnected\", onDisconnectedHandler);\n        };\n    }, [instance]);\n\n    // Disconnect when unmounted\n    useEffect(() => {\n        return (): void => {\n            instance?.disconnect();\n        };\n    }, [instance]);\n\n    return (\n        <LivelinkContext.Provider\n            value={{\n                instance,\n                isConnecting,\n                isDisconnected: isConnectionLost,\n                disconnect,\n            }}\n        >\n            {isConnecting && LoadingPanel && <LoadingPanel stage={\"\"} />}\n            {isConnectionLost && ConnectionErrorPanel && <ConnectionErrorPanel error={connectionError} />}\n            {inactivityWarning && InactivityWarningPanel && (\n                <InactivityWarningPanel\n                    warningDuration={inactivityWarning.seconds_remaining}\n                    onActivityDetected={() => {\n                        inactivityWarning.resetTimer();\n                        setInactivityWarning(null);\n                    }}\n                />\n            )}\n            {children}\n        </LivelinkContext.Provider>\n    );\n}\n\n//------------------------------------------------------------------------------\nfunction configureClient(instance: LivelinkInstance): void {\n    const configure = async (): Promise<void> => {\n        instance.session.removeEventListener(\"TO_REMOVE__viewports-added\", configure);\n\n        console.debug(\"-- Configuring client\");\n        const webcodec = await Livelink.WebCodecsDecoder.findSupportedCodec();\n        await instance.configureRemoteServer({ codec: webcodec || undefined });\n\n        await instance.setEncodedFrameConsumer({\n            encoded_frame_consumer:\n                webcodec !== null\n                    ? new Livelink.WebCodecsDecoder({ decoded_frame_consumer: instance.default_decoded_frame_consumer })\n                    : new Livelink.SoftwareDecoder({ decoded_frame_consumer: instance.default_decoded_frame_consumer }),\n        });\n\n        instance.TO_REMOVE__startIfReady();\n    };\n\n    instance.session.addEventListener(\"TO_REMOVE__viewports-added\", configure);\n}\n\n//------------------------------------------------------------------------------\nfunction getConnectionPromiseKey(params: LivelinkConnectParameters): string {\n    return JSON.stringify(params);\n}\n\n//------------------------------------------------------------------------------\nexport { LivelinkProvider as Livelink };\n", "//------------------------------------------------------------------------------\nimport { useContext, useEffect, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport { Client } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"../components/core/Livelink\";\n\n/**\n * Provides a list of all clients connected to the current session.\n *\n * @category Hooks\n */\nexport function useClients(): { clients: Array<Client> } {\n    const { instance } = useContext(LivelinkContext);\n\n    const [clients, setClients] = useState<Array<Client>>([]);\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        const onClientsChanged = (): void => setClients(instance.session.other_clients);\n\n        instance.session.addEventListener(\"on-client-joined\", onClientsChanged);\n        instance.session.addEventListener(\"on-client-left\", onClientsChanged);\n\n        onClientsChanged();\n\n        return (): void => {\n            instance.session.removeEventListener(\"on-client-joined\", onClientsChanged);\n            instance.session.removeEventListener(\"on-client-left\", onClientsChanged);\n            setClients([]);\n        };\n    }, [instance]);\n\n    return { clients };\n}\n", "//------------------------------------------------------------------------------\nimport type { Vec3, Quat, RenderGraphDataObject, Entity, UUID, ComponentName, Components } from \"@3dverse/livelink\";\nimport { useEntity } from \"./useEntity\";\nimport { StrictUnion } from \"../utils\";\n\n/**\n * An exclusive union of the perspective and orthographic lenses.\n * @inline\n * @internal\n */\nexport type CameraLensProps =\n    | {\n          /**\n           * The perspective lens of the camera entity, can't be used with orthographic_lens.\n           */\n          perspective_lens?: Partial<Components.PerspectiveLens>;\n      }\n    | {\n          /**\n           * The orthographic lens of the camera entity, can't be used with perspective_lens.\n           */\n          orthographic_lens?: Partial<Components.OrthographicLens>;\n      };\n\n/**\n * The properties of the render graph the camera will entity use.\n * @inline\n * @internal\n */\nexport type RenderGraphProps = {\n    /**\n     * The render graph to use within the camera entity.\n     */\n    renderGraphRef?: UUID;\n\n    /**\n     * The settings of the camera entity.\n     */\n    settings?: RenderGraphDataObject;\n\n    /**\n     * The render target index to use to render the frame.\n     */\n    renderTargetIndex?: number;\n};\n\n/**\n * The properties of the initial transform of the camera entity.\n * Defines an exclusive union between orientation and eulerOrientation.\n * @inline\n * @internal\n */\nexport type OrientationProps =\n    | {\n          /**\n           * The initial orientation of the camera entity in quaternion form, can't be used with eulerOrientation.\n           */\n          orientation?: Quat;\n      }\n    | {\n          /**\n           * The initial orientation of the camera entity in Euler angles form, can't be used with orientation.\n           */\n          eulerOrientation?: Vec3;\n      };\n\n/**\n * The properties used to create a camera entity.\n * @inline\n * @internal\n */\nexport type UseCameraEntityProps = {\n    /**\n     * The name of the camera entity.\n     */\n    name?: string;\n\n    /**\n     * The initial position of the camera entity.\n     */\n    position?: Vec3;\n} & StrictUnion<OrientationProps> &\n    StrictUnion<CameraLensProps> &\n    RenderGraphProps;\n\n/**\n * A hook that creates a camera entity.\n *\n * @param props - The properties used to create the camera entity.\n * @param watchedComponents - The components to watch for changes. If any component in this list changes,\n * the entity trigger a redraw. If set to \"any\", the entity will trigger a redraw on any component change.\n *\n * @returns The camera entity and a boolean indicating if the entity is pending creation.\n *\n * @category Hooks\n */\nexport function useCameraEntity(\n    props: UseCameraEntityProps = {},\n    watchedComponents: Array<ComponentName> | \"any\" = [],\n): {\n    isPending: boolean;\n    cameraEntity: Entity | null;\n} {\n    const {\n        name = \"Camera\",\n        position = [0, 1, 5],\n        orientation: _orientation = [0, 0, 0, 1],\n        eulerOrientation: _eulerOrientation = [0, 0, 0],\n        renderGraphRef = \"398ee642-030a-45e7-95df-7147f6c43392\",\n        settings = { grid: true, skybox: false, gradient: true },\n        renderTargetIndex = -1,\n        perspective_lens: _perspective_lens = { fovy: 60, nearPlane: 0.1, farPlane: 10000 },\n    } = props;\n\n    const orientation = \"orientation\" in props ? _orientation : undefined;\n    const eulerOrientation = !orientation && \"eulerOrientation\" in props ? _eulerOrientation : undefined;\n\n    const orthographic_lens = \"orthographic_lens\" in props ? props.orthographic_lens : undefined;\n    const perspective_lens = !orthographic_lens ? _perspective_lens : undefined;\n\n    const { isPending, entity: cameraEntity } = useEntity(\n        {\n            name,\n            components: {\n                local_transform: { position, orientation, eulerOrientation },\n                camera: { renderGraphRef, dataJSON: settings, renderTargetIndex },\n                perspective_lens,\n                orthographic_lens,\n            },\n            options: { auto_broadcast: false, delete_on_client_disconnection: true },\n        },\n        watchedComponents,\n    );\n\n    return { isPending, cameraEntity };\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    CSSProperties,\n    HTMLProps,\n    JSX,\n    PropsWithChildren,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport { RenderingSurface } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"./Livelink\";\n\n/**\n * Context providing the canvas element and the rendering surface.\n *\n * @param canvas - The canvas element.\n * @param renderingSurface - The rendering surface.\n *\n * @category Contexts\n */\nexport const CanvasContext = createContext<{\n    canvas: HTMLCanvasElement | null;\n    renderingSurface: RenderingSurface | null;\n}>({\n    canvas: null,\n    renderingSurface: null,\n});\n\n//------------------------------------------------------------------------------\ntype CanvasContext =\n    | {\n          contextType: \"2d\";\n          contextAttributes?: CanvasRenderingContext2DSettings;\n      }\n    | {\n          contextType: \"webgl\";\n          contextAttributes?: WebGLContextAttributes & { xrCompatible?: boolean };\n      }\n    | {\n          contextType?: undefined;\n          contextAttributes?: undefined;\n      };\n\n/**\n * A component that provides a canvas element and a rendering surface.\n *\n * @param params - The canvas context.\n * @param params.children - The children to render.\n * @param params.contextType - The context type of the canvas.\n * @param params.contextAttributes - The context attributes of the canvas.\n * @param params.width - The width of the canvas.\n * @param params.height - The height of the canvas.\n *\n * @returns The canvas component.\n *\n * @category Components\n */\nexport function Canvas({\n    children,\n    contextType = \"2d\",\n    contextAttributes,\n    width,\n    height,\n    ...props\n}: PropsWithChildren<CanvasContext & HTMLProps<HTMLDivElement>>): JSX.Element {\n    const { instance } = useContext(LivelinkContext);\n    const { canvas: parentCanvas } = useContext(CanvasContext);\n\n    const [renderingSurface, setRenderingSurface] = useState<RenderingSurface | null>(null);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    useEffect(() => {\n        if (!instance || !canvasRef.current) {\n            return;\n        }\n\n        console.debug(\"--- Setting rendering surface\");\n\n        const rect = canvasRef.current.getBoundingClientRect();\n        if (!rect.width || !rect.height) {\n            console.error(\n                `Canvas element has an invalid size : [${rect.width} x ${rect.height}] it will not be mounted as a rendering surface.`,\n                canvasRef.current,\n            );\n            return;\n        }\n\n        const surface = new RenderingSurface({\n            canvas_element: canvasRef.current,\n            context_type: contextType,\n            context_attributes: contextAttributes,\n        });\n\n        setRenderingSurface(surface);\n\n        return (): void => {\n            console.debug(\"--- Removing rendering surface\");\n            surface.release();\n            setRenderingSurface(null);\n        };\n    }, [instance, contextType, contextAttributes]);\n\n    return (\n        <CanvasContext.Provider value={{ canvas: canvasRef.current, renderingSurface }}>\n            <div\n                data-role=\"canvas-container\"\n                style={computeCanvasContainerStyle({ parentCanvas, width, height })}\n                {...props}\n            >\n                <canvas\n                    ref={canvasRef}\n                    style={{\n                        position: \"absolute\",\n                        width: \"100%\",\n                        height: \"100%\",\n                        pointerEvents: \"none\",\n                    }}\n                />\n                {children}\n            </div>\n        </CanvasContext.Provider>\n    );\n}\n\n//------------------------------------------------------------------------------\nfunction computeCanvasContainerStyle({\n    parentCanvas,\n    width,\n    height,\n}: {\n    parentCanvas: HTMLCanvasElement | null;\n    width?: string | number;\n    height?: string | number;\n}): CSSProperties {\n    const isNestedCanvas = Boolean(parentCanvas);\n    const commonStyle = { overflow: \"clip\" } satisfies CSSProperties;\n    const nestedCanvasStyle = { position: \"absolute\", width, height } satisfies CSSProperties;\n    const rootCanvasStyle = {\n        position: \"relative\",\n        width: width ?? \"100%\",\n        height: height ?? \"100%\",\n    } satisfies CSSProperties;\n    return { ...commonStyle, ...(isNestedCanvas ? nestedCanvasStyle : rootCanvasStyle) };\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    forwardRef,\n    HTMLProps,\n    JSX,\n    Ref,\n    PropsWithChildren,\n    useCallback,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n    useImperativeHandle,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport * as Livelink from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"./Livelink\";\nimport { CanvasContext } from \"./Canvas\";\nimport { StrictUnion } from \"../../utils\";\n\n/**\n * Context that provides a viewport.\n *\n * @category Contexts\n */\nexport const ViewportContext = createContext<{\n    viewport: Livelink.Viewport | null;\n    viewportDomElement: HTMLDivElement | null;\n    zIndex: number;\n    camera: Livelink.CameraProjection | null;\n}>({\n    viewport: null,\n    viewportDomElement: null,\n    zIndex: 0,\n    camera: null,\n});\n\n/**\n * A viewport component.\n *\n * @category Components\n */\nexport const Viewport = forwardRef(function (\n    {\n        setHoveredEntity,\n        setPickedEntity,\n        renderTargetIndex = -1,\n        children,\n        ...props\n    }: PropsWithChildren<\n        StrictUnion<\n            | {\n                  cameraEntity: Livelink.Entity | null;\n              }\n            | {\n                  client: Livelink.Client;\n                  cameraIndex?: number;\n              }\n        > & {\n            setHoveredEntity?: (\n                data: { entity: Livelink.Entity; ws_position: Livelink.Vec3; ws_normal: Livelink.Vec3 } | null,\n            ) => void;\n            setPickedEntity?: (\n                data: { entity: Livelink.Entity; ws_position: Livelink.Vec3; ws_normal: Livelink.Vec3 } | null,\n            ) => void;\n            renderTargetIndex?: number;\n        } & HTMLProps<HTMLDivElement>\n    >,\n    ref: Ref<Livelink.Viewport | undefined>,\n): JSX.Element {\n    const { cameraEntity, client, cameraIndex, ...otherProps } = props as {\n        cameraEntity?: Livelink.Entity | null;\n        cameraIndex?: number;\n        client?: Livelink.Client;\n    } & HTMLProps<HTMLDivElement>;\n\n    //--------------------------------------------------------------------------\n    const { instance } = useContext(LivelinkContext);\n    const { renderingSurface, canvas } = useContext(CanvasContext);\n    const { zIndex: parentZIndex = 0 } = useContext(ViewportContext);\n\n    //--------------------------------------------------------------------------\n    const [viewport, setViewport] = useState<Livelink.Viewport | null>(null);\n    const [clientCameraEntity, setClientCameraEntity] = useState<Livelink.Entity | null>(null);\n    const [camera, setCamera] = useState<Livelink.CameraProjection | null>(null);\n    const viewportDomElement = useRef<HTMLDivElement>(null);\n\n    //--------------------------------------------------------------------------\n    useImperativeHandle(ref, () => viewport ?? undefined, [viewport]);\n\n    //--------------------------------------------------------------------------\n    const onResize = useCallback(() => {\n        if (!viewportDomElement.current || !canvas || !viewport) {\n            return;\n        }\n\n        console.debug(\"---- Resizing viewport\", viewportDomElement.current);\n        viewport.relative_rect = Livelink.RelativeRect.from_dom_elements({\n            element: viewportDomElement.current,\n            parent: canvas,\n        });\n    }, [viewport, canvas, viewportDomElement.current]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewportDomElement.current) {\n            return;\n        }\n\n        const resizeObserver = new ResizeObserver(onResize);\n        resizeObserver.observe(viewportDomElement.current);\n        return (): void => {\n            resizeObserver.disconnect();\n        };\n    }, [viewportDomElement.current, onResize]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!renderingSurface) {\n            return;\n        }\n\n        renderingSurface.addEventListener(\"on-rendering-surface-resized\", onResize);\n        return (): void => {\n            renderingSurface.removeEventListener(\"on-rendering-surface-resized\", onResize);\n        };\n    }, [renderingSurface, onResize]);\n\n    //--------------------------------------------------------------------------\n    const zIndex = parentZIndex + 1;\n    useEffect(() => {\n        if (!instance || !renderingSurface || !canvas || !viewportDomElement.current) {\n            return;\n        }\n\n        try {\n            const rect = Livelink.RelativeRect.from_dom_elements({\n                element: viewportDomElement.current,\n                parent: canvas,\n            });\n\n            const viewport = new Livelink.Viewport({\n                core: instance,\n                rendering_surface: renderingSurface,\n                options: {\n                    rect,\n                    z_index: zIndex,\n                    render_target_index: renderTargetIndex,\n                    dom_element: viewportDomElement.current,\n                },\n            });\n\n            console.debug(\"---- Setting viewport\", viewport.width, viewport.height, zIndex);\n            instance.addViewports({ viewports: [viewport] });\n            setViewport(viewport);\n\n            return (): void => {\n                console.debug(\"---- Removing viewport\");\n                instance.removeViewport({ viewport });\n                viewport.release();\n                setViewport(null);\n            };\n        } catch (error) {\n            if (error instanceof Livelink.OutOfBoundsError) {\n                console.error(\n                    \"A viewport MUST be contained into its parent Canvas bounds\",\n                    viewportDomElement.current,\n                    canvas,\n                );\n            } else if (error instanceof Livelink.InvalidSizeError) {\n                console.error(\n                    `Viewport element has an invalid size : [${error.rect.width} x ${error.rect.height}].`,\n                    canvas,\n                );\n            } else {\n                console.error(\"Failed to mount viewport\", viewportDomElement.current, error);\n            }\n        }\n    }, [instance, renderingSurface, canvas, zIndex]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (client) {\n            client.getCameraEntities().then(cameraEntities => {\n                setClientCameraEntity(cameraEntities[cameraIndex ?? 0]);\n            });\n        } else {\n            setClientCameraEntity(cameraEntity ?? null);\n        }\n    }, [cameraEntity, client, cameraIndex]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewport || !clientCameraEntity) {\n            return;\n        }\n\n        console.debug(\"---- Setting camera\", clientCameraEntity);\n        viewport.camera_projection = new Livelink.CameraProjection({ camera_entity: clientCameraEntity, viewport });\n        setCamera(viewport.camera_projection);\n    }, [viewport, clientCameraEntity]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewport) {\n            return;\n        }\n\n        const onEntityPicked = (e: Livelink.EntityPickedEvent): void =>\n            setPickedEntity?.(\n                e.picked_entity && e.ws_position && e.ws_normal\n                    ? { entity: e.picked_entity, ws_position: e.ws_position, ws_normal: e.ws_normal }\n                    : null,\n            );\n        if (setPickedEntity) {\n            viewport.activatePicking();\n            viewport.addEventListener(\"on-entity-picked\", onEntityPicked);\n        }\n\n        const onEntityHovered = (e: Livelink.EntityHoveredEvent): void =>\n            setHoveredEntity?.(\n                e.hovered_entity && e.ws_position && e.ws_normal\n                    ? { entity: e.hovered_entity, ws_position: e.ws_position, ws_normal: e.ws_normal }\n                    : null,\n            );\n        if (setHoveredEntity) {\n            viewport.activateHovering();\n            viewport.addEventListener(\"on-entity-hovered\", onEntityHovered);\n        }\n\n        return (): void => {\n            if (setPickedEntity) {\n                viewport.removeEventListener(\"on-entity-picked\", onEntityPicked);\n                viewport.deactivatePicking();\n            }\n\n            if (setHoveredEntity) {\n                viewport.removeEventListener(\"on-entity-hovered\", onEntityHovered);\n                viewport.deactivateHovering();\n            }\n        };\n    }, [viewport, setPickedEntity, setHoveredEntity]);\n\n    //--------------------------------------------------------------------------\n    return (\n        <ViewportContext.Provider\n            value={{\n                viewport,\n                viewportDomElement: viewportDomElement.current,\n                zIndex,\n                camera: camera,\n            }}\n        >\n            <div ref={viewportDomElement} data-role=\"viewport\" {...otherProps}>\n                {children}\n            </div>\n        </ViewportContext.Provider>\n    );\n});\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    forwardRef,\n    PropsWithChildren,\n    Ref,\n    useContext,\n    useEffect,\n    useImperativeHandle,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport {\n    CameraController as DefaultCameraController,\n    CameraControllerPresets,\n    CameraControllerPreset,\n} from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { ViewportContext } from \"./Viewport\";\n\n/**\n * Context that provides a camera controller.\n *\n * @category Contexts\n */\nexport const CameraControllerContext = createContext<{\n    cameraController: DefaultCameraController | undefined;\n}>({\n    cameraController: undefined,\n});\n\n/**\n * A component that provides a camera controller.\n *\n * @category Components\n */\nexport const CameraController = forwardRef(function CameraController(\n    { preset = CameraControllerPresets.orbital, children }: PropsWithChildren & { preset?: CameraControllerPreset },\n    ref: Ref<DefaultCameraController | undefined>,\n) {\n    const { viewport, camera } = useContext(ViewportContext);\n    const [cameraController, setCameraController] = useState<DefaultCameraController | undefined>(undefined);\n    useImperativeHandle(ref, () => cameraController, [cameraController]);\n\n    useEffect(() => {\n        if (!viewport || !camera) {\n            return;\n        }\n\n        const controller = new DefaultCameraController({\n            camera_entity: camera.camera_entity,\n            viewport,\n            preset,\n        });\n\n        setCameraController(controller);\n\n        return (): void => {\n            controller.release();\n            setCameraController(undefined);\n        };\n    }, [viewport, camera, preset]);\n\n    return <CameraControllerContext.Provider value={{ cameraController }}>{children}</CameraControllerContext.Provider>;\n});\n", "import React, { ReactNode, useContext, useEffect, useMemo, useState } from \"react\";\nimport { CanvasContext } from \"../core/Canvas\";\n\n/**\n * @experimental\n *\n * Recorder component for recording video from a canvas.\n *\n * @category Components\n */\nexport function Recorder({\n    fileOptions = {\n        description: \"Video recording\",\n        accept: {\n            \"video/webm\": [\".webm\"],\n        },\n    },\n    recorderOptions = {\n        mimeType: `video/webm; codecs=\"vp8\"`,\n        videoBitsPerSecond: 10000000,\n    },\n    streamOptions = {\n        frameRequestRate: 30,\n    },\n    children,\n}: {\n    fileOptions?: FilePickerAcceptType;\n    recorderOptions?: MediaRecorderOptions;\n    streamOptions?: { frameRequestRate: number };\n    children?: (props: { recordTime: number }) => ReactNode;\n}): ReactNode {\n    const { renderingSurface } = useContext(CanvasContext);\n    const [recordTime, setRecordTime] = useState(0);\n    const [isRecording, setIsRecording] = useState(false);\n\n    const mediaRecorder = useMemo(() => {\n        if (!renderingSurface) {\n            return null;\n        }\n\n        const stream = renderingSurface.canvas.captureStream(streamOptions.frameRequestRate);\n        return new MediaRecorder(stream, recorderOptions);\n    }, [renderingSurface]);\n\n    useEffect(() => {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        window.showSaveFilePicker({ types: [fileOptions] }).then(async (fileHandle: FileSystemFileHandle) => {\n            const fileStream: FileSystemWritableFileStream = await fileHandle.createWritable();\n            mediaRecorder.ondataavailable = (event: BlobEvent): void => {\n                if (event.data.size > 0) {\n                    fileStream.write(event.data);\n                }\n            };\n            mediaRecorder.onstop = (): void => {\n                fileStream.close();\n            };\n            mediaRecorder.start();\n            setIsRecording(true);\n        });\n\n        return (): void => {\n            mediaRecorder.stop();\n        };\n    }, [mediaRecorder]);\n\n    useEffect(() => {\n        if (!isRecording) {\n            return;\n        }\n\n        const interval = setInterval(() => {\n            setRecordTime((prev: number) => prev + 1);\n        }, 1000);\n\n        return (): void => clearInterval(interval);\n    }, [isRecording]);\n\n    return <>{children ? children({ recordTime }) : null}</>;\n}\n", "export * from \"./hooks/useEntity\";\nexport * from \"./hooks/useClients\";\nexport * from \"./hooks/useCameraEntity\";\n\nexport * from \"./components/core/Livelink\";\nexport * from \"./components/core/Canvas\";\nexport * from \"./components/core/Viewport\";\nexport * from \"./components/core/CameraController\";\nexport * from \"./components/utils/Recorder\";\nexport { CameraController as DefaultCameraController } from \"@3dverse/livelink\";\n\nexport * from \"./components/overlays/DOM3DOverlay\";\nexport * from \"./components/overlays/DOM3DElement\";\nexport * from \"./components/overlays/DOMEntity\";\n\nexport * from \"./overlays/ReactOverlay\";\nexport * from \"./overlays/React3DElement\";\n\nexport * from \"./utils\";\n\n//------------------------------------------------------------------------------\n/**\n * Version of the Livelink React library, injected by the build system.\n * @internal\n */\ndeclare const LIVELINK_REACT_VERSION: string;\n\n/**\n * Name of the package, injected by the build system.\n * @internal\n */\ndeclare const PACKAGE_NAME: string;\n\n//------------------------------------------------------------------------------\ndeclare global {\n    interface Window {\n        __LIVELINK__: Record<string, string>;\n    }\n}\n\n//------------------------------------------------------------------------------\nif (typeof window !== \"undefined\") {\n    if (!window.__LIVELINK__) {\n        window.__LIVELINK__ = {};\n    }\n\n    if (Object.prototype.hasOwnProperty.call(window.__LIVELINK__, PACKAGE_NAME)) {\n        console.warn(\"\u26A0\uFE0F WARNING \u26A0\uFE0F Multiple instances of Livelink React \u269B\uFE0F being imported.\");\n    } else {\n        window.__LIVELINK__[PACKAGE_NAME] = LIVELINK_REACT_VERSION;\n    }\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    HTMLProps,\n    JSX,\n    PropsWithChildren,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport { ViewportContext } from \"../core/Viewport\";\nimport { ReactOverlay } from \"../../overlays/ReactOverlay\";\n\n/**\n * Context that provides an overlay.\n *\n * @category Contexts\n */\nexport const OverlayContext = createContext<ReactOverlay | null>(null);\n\n/**\n * A component that provides a DOM 3D overlay.\n *\n * @category Components\n */\nexport function DOM3DOverlay({ children, ...props }: PropsWithChildren<HTMLProps<HTMLDivElement>>): JSX.Element {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const [overlay, setOverlay] = useState<ReactOverlay | null>(null);\n    const { viewport } = useContext(ViewportContext);\n\n    useEffect(() => {\n        if (!viewport || !containerRef.current) {\n            return;\n        }\n\n        const overlay = new ReactOverlay({ container: containerRef.current, viewport });\n        viewport.addOverlay({ overlay });\n\n        setOverlay(overlay);\n\n        return (): void => {\n            viewport.removeOverlay({ overlay });\n        };\n    }, [viewport, containerRef]);\n\n    return (\n        <OverlayContext.Provider value={overlay}>\n            <div\n                ref={containerRef}\n                data-role=\"dom-3d-overlay\"\n                style={{\n                    position: \"absolute\",\n                    width: \"100%\",\n                    height: \"100%\",\n                    top: \"0\",\n                    pointerEvents: \"none\",\n                    padding: \"inherit\",\n                    overflow: \"hidden\",\n                }}\n                {...props}\n            >\n                {children}\n            </div>\n        </OverlayContext.Provider>\n    );\n}\n", "import React, { PropsWithChildren, ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { vec3 } from \"gl-matrix\";\nimport type { ReactOverlay, Projection } from \"./ReactOverlay\";\nimport { Vec2 } from \"@3dverse/livelink\";\n\n/**\n *\n */\nexport type Anchor =\n    | \"left-top\"\n    | \"left-center\"\n    | \"left-bottom\"\n    | \"center-top\"\n    | \"center\"\n    | \"center-bottom\"\n    | \"right-top\"\n    | \"right-center\"\n    | \"right-bottom\";\n\n/**\n *\n */\ntype HorizontalAnchor = \"left\" | \"center\" | \"right\";\n\n/**\n *\n */\ntype VerticalAnchor = \"top\" | \"center\" | \"bottom\";\n\n/**\n *\n */\nexport type React3DElementProps = PropsWithChildren<{\n    worldPosition: vec3;\n    anchor: Anchor;\n    scaleFactor?: number;\n}>;\n\n/**\n * @internal\n */\nexport function createReact3DElementFactory(overlay: ReactOverlay): (props: React3DElementProps) => React.ReactElement {\n    return (props: React3DElementProps): React.ReactElement => {\n        return <React3DElement overlay={overlay} {...props} />;\n    };\n}\n\n/**\n * @internal\n */\nexport class React3DElement extends React.Component<\n    { overlay: ReactOverlay } & React3DElementProps,\n    { screen_position: vec3; z_index: number; scale: number; is_visible: boolean; translation: Vec2 }\n> {\n    /**\n     *\n     */\n    static VerticalAnchorPositions: Record<VerticalAnchor, number> = {\n        top: 0,\n        center: -50,\n        bottom: -100,\n    };\n\n    /**\n     *\n     */\n    static HorizontalAnchorPositions: Record<HorizontalAnchor, number> = {\n        left: 0,\n        center: -50,\n        right: -100,\n    };\n\n    /**\n     *\n     */\n    state = {\n        screen_position: vec3.create(),\n        z_index: 0,\n        scale: 1,\n        is_visible: false,\n        translation: [0, 0] as Vec2,\n    };\n\n    /**\n     *\n     */\n    componentDidMount(): void {\n        this.#updateTranslation();\n        this.props.overlay._registerElement(this);\n    }\n\n    /**\n     *\n     */\n    componentDidUpdate(\n        prevProps: Readonly<\n            { overlay: ReactOverlay } & React3DElementProps & {\n                    children?: ReactNode | undefined;\n                }\n        >,\n    ): void {\n        if (\n            prevProps.worldPosition.some((v, i) => v !== this.props.worldPosition[i]) ||\n            prevProps.anchor !== this.props.anchor ||\n            prevProps.scaleFactor !== this.props.scaleFactor\n        ) {\n            this.#updateTranslation();\n            this.props.overlay._updateElement();\n        }\n    }\n\n    /**\n     *\n     */\n\n    /**\n     *\n     */\n    componentWillUnmount(): void {\n        this.props.overlay._unregisterElement(this);\n    }\n\n    /**\n     *\n     */\n    get screen_position(): vec3 {\n        return this.state.screen_position;\n    }\n\n    /**\n     *\n     */\n    get world_position(): vec3 {\n        return this.props.worldPosition;\n    }\n\n    /**\n     *\n     */\n    get scale_factor(): number | undefined {\n        return this.props.scaleFactor;\n    }\n\n    /**\n     *\n     */\n    setProjection(state: Projection & { z_index: number }): void {\n        this.setState(state);\n    }\n\n    /**\n     *\n     */\n    #updateTranslation(): void {\n        if (this.props.anchor === \"center\") {\n            this.setState({\n                translation: [\n                    React3DElement.HorizontalAnchorPositions.center,\n                    React3DElement.VerticalAnchorPositions.center,\n                ],\n            });\n            return;\n        }\n\n        const [anchor_x, anchor_y] = this.props.anchor.split(\"-\") as [HorizontalAnchor, VerticalAnchor];\n\n        this.setState({\n            translation: [\n                React3DElement.HorizontalAnchorPositions[anchor_x],\n                React3DElement.VerticalAnchorPositions[anchor_y],\n            ],\n        });\n    }\n\n    /**\n     *\n     */\n    render(): ReactNode {\n        if (!this.state.is_visible) {\n            return null;\n        }\n\n        const transformStyle = `\n            translate(${this.state.translation[0]}%, ${this.state.translation[1]}%)\n            translate(${this.state.screen_position[0]}px, ${this.state.screen_position[1]}px)`;\n\n        return createPortal(\n            <div\n                style={{\n                    position: \"absolute\",\n                    transform: transformStyle,\n                    zIndex: this.state.z_index,\n                    pointerEvents: \"auto\",\n                }}\n            >\n                {this.scale_factor ? (\n                    <div style={{ transform: `scale(${this.state.scale})` }}>{this.props.children}</div>\n                ) : (\n                    this.props.children\n                )}\n            </div>,\n            this.props.overlay.container,\n        );\n    }\n}\n", "/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};", "import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();", "//------------------------------------------------------------------------------\nimport React from \"react\";\n\n//------------------------------------------------------------------------------\nimport type { Vec3, OverlayInterface, Viewport } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { React3DElement, React3DElementProps, createReact3DElementFactory } from \"./React3DElement\";\n\n/**\n *\n */\nconst INFINITE_FAR_VALUE = 100000;\n\n/**\n *\n */\nexport type Projection = {\n    screen_position: Vec3;\n    scale: number;\n    is_visible: boolean;\n};\n\n/**\n *\n */\nexport class ReactOverlay implements OverlayInterface {\n    /**\n     *\n     */\n    readonly container: HTMLDivElement;\n\n    /**\n     *\n     */\n    readonly #elements: Set<React3DElement> = new Set();\n\n    /**\n     *\n     */\n    readonly #viewport: Viewport;\n\n    /**\n     *\n     */\n    readonly #factory: (props: React3DElementProps) => React.ReactElement;\n\n    /**\n     *\n     */\n    constructor({ container, viewport }: { container: HTMLDivElement; viewport: Viewport }) {\n        this.container = container;\n        this.#viewport = viewport;\n        this.#factory = createReact3DElementFactory(this);\n    }\n\n    /**\n     *\n     */\n    get DOM3DElement(): (props: React3DElementProps) => React.ReactElement {\n        return this.#factory;\n    }\n\n    /**\n     * @internal\n     */\n    _registerElement(react_element: React3DElement): void {\n        this.#elements.add(react_element);\n        this.#viewport.rendering_surface.redrawLastFrame();\n    }\n\n    /**\n     * @internal\n     */\n    _unregisterElement(react_element: React3DElement): void {\n        if (!this.#elements.delete(react_element)) {\n            console.warn(`Element ref not found in dom overlay`);\n        }\n    }\n\n    _updateElement(): void {\n        this.#viewport.rendering_surface.redrawLastFrame();\n    }\n\n    /**\n     *\n     */\n    resize({ width, height }: { width: number; height: number }): void {\n        this.container.style.width = width + \"px\";\n        this.container.style.height = height + \"px\";\n    }\n\n    /**\n     *\n     */\n    draw(): OffscreenCanvas | null {\n        if (!this.#viewport.isValid()) {\n            return null;\n        }\n\n        this.updateElements();\n        return null;\n    }\n\n    /**\n     *\n     */\n    updateElements(): void {\n        const elements: Array<{\n            projection: Projection;\n            react_element: React3DElement;\n        }> = [];\n\n        for (const react_element of this.#elements.values()) {\n            const projection = this.#projectElementOnScreen({ react_element });\n            elements.push({ projection, react_element });\n        }\n\n        elements.sort((a, b) => b.projection.screen_position[2] - a.projection.screen_position[2]);\n        elements.forEach(({ projection, react_element }, z_index) => {\n            react_element.setProjection({ ...projection, z_index });\n        });\n    }\n\n    /**\n     *\n     */\n    #projectElementOnScreen({ react_element }: { react_element: React3DElement }): Projection {\n        const screen_position = this.#viewport.projectWorldToScreen({\n            world_position: react_element.world_position as Vec3,\n            out_screen_position: react_element.screen_position as Vec3,\n        });\n\n        const scale = react_element.scale_factor\n            ? this.#computeElementScale({ screen_position, scale_factor: react_element.scale_factor })\n            : 1.0;\n\n        const is_visible = screen_position[2] < 1.0 && screen_position[2] > 0;\n\n        return {\n            screen_position,\n            scale,\n            is_visible,\n        };\n    }\n\n    /**\n     *\n     */\n    #computeElementScale({ screen_position, scale_factor }: { screen_position: Vec3; scale_factor: number }): number {\n        const camera = this.#viewport.camera_projection?.camera_entity;\n        if (!camera) {\n            throw new Error(\"Viewport has no camera\");\n        }\n\n        const near =\n            (camera.perspective_lens ? camera.perspective_lens.nearPlane : camera.orthographic_lens?.zFar) ?? 0;\n        const far =\n            (camera.perspective_lens\n                ? camera.perspective_lens.farPlane || INFINITE_FAR_VALUE\n                : camera.orthographic_lens?.zNear) ?? 1;\n\n        return (far - near) * (1 - screen_position[2]) * scale_factor;\n    }\n\n    /**\n     *\n     */\n    release(): void {\n        // We need to unmount the root in the next event loop\n        // iteration to avoid unmounting the root while rendering.\n        setTimeout(() => {\n            this.#elements.clear();\n        }, 0);\n    }\n}\n", "//------------------------------------------------------------------------------\nimport React, { PropsWithChildren, useContext } from \"react\";\nimport type { Vec3 } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { OverlayContext } from \"./DOM3DOverlay\";\nimport type { Anchor } from \"../../overlays/React3DElement\";\n\n/**\n * A component that renders a 3D DOM element.\n *\n * @category Components\n */\nexport function DOM3DElement({\n    worldPosition,\n    anchor = \"center\",\n    scaleFactor,\n    children,\n}: PropsWithChildren<{\n    worldPosition: Vec3;\n    anchor?: Anchor;\n    scaleFactor?: number;\n}>): React.JSX.Element | null {\n    const overlay = useContext(OverlayContext);\n    if (!overlay) {\n        return null;\n    }\n\n    return (\n        <overlay.DOM3DElement worldPosition={worldPosition} anchor={anchor} scaleFactor={scaleFactor}>\n            {children}\n        </overlay.DOM3DElement>\n    );\n}\n", "//------------------------------------------------------------------------------\nimport React, { JSX, PropsWithChildren, useEffect, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport type { Entity, Vec3 } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { DOM3DElement } from \"./DOM3DElement\";\nimport { Anchor } from \"../../overlays/React3DElement\";\n\n/**\n * A component that renders a DOM element at the position of an entity.\n *\n * @category Components\n */\nexport function DOMEntity({\n    entity,\n    scaleFactor,\n    anchor,\n    children,\n}: PropsWithChildren<{\n    entity: Entity | null;\n    anchor?: Anchor;\n    scaleFactor?: number;\n}>): JSX.Element | null {\n    const [worldPosition, setWorldPosition] = useState<Vec3>(entity ? entity.global_transform.position : [0, 0, 0]);\n    const [isVisible, setIsVisible] = useState(entity ? entity.is_visible : false);\n\n    useEffect(() => {\n        if (!entity) {\n            return;\n        }\n\n        const updatePosition = (): void => setWorldPosition(entity.global_transform.position);\n        const updateVisibility = (): void => setIsVisible(entity.is_visible);\n\n        // Initialize states\n        updatePosition();\n        updateVisibility();\n\n        entity.addEventListener(\"on-entity-updated\", updatePosition);\n        entity.addEventListener(\"on-entity-visibility-changed\", updateVisibility);\n        return (): void => {\n            entity.removeEventListener(\"on-entity-updated\", updatePosition);\n            entity.removeEventListener(\"on-entity-visibility-changed\", updateVisibility);\n        };\n    }, [entity]);\n\n    if (!entity || !isVisible) {\n        return null;\n    }\n\n    return (\n        <DOM3DElement worldPosition={worldPosition} anchor={anchor} scaleFactor={scaleFactor}>\n            {children}\n        </DOM3DElement>\n    );\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,mBAA4D;ACA5D,IAAAA,gBAAuG;ACAvG,IAAAC,gBAAgD;AEAhD,IAAAA,gBAUO;ACVP,IAAAC,gBAaO;ACbP,IAAAC,gBASO;ACVP,IAAAC,gBAA2E;AEC3E,IAAAC,gBASO;ACVP,IAAAA,gBAAoD;AACpD,uBAA6B;AIA7B,IAAAA,iBAAqD;ACArD,IAAAA,iBAAmE;;;;;Ade5D,IAAMC,QAAkBC,cAAAA,eAY5B,EACC,UAAU,MACV,cAAc,OACd,gBAAgB,OAChB,YAAY,MAAM;AAAC,EACvB,CAAC;AA0HM,SAASC,GAAiB,EAC7B,SAAAC,GACA,WAAAC,GACA,aAAAC,GACA,OAAAC,GACA,cAAAC,GACA,wBAAAC,GACA,sBAAAC,GACA,kBAAAC,IAAmB,MACnB,YAAAC,GACA,UAAAC,EACJ,GAA8D;AAC1D,MAAM,CAACC,GAAUC,CAAW,QAAIC,cAAAA,UAAkC,IAAI,GAChE,CAACC,GAAcC,CAAe,QAAIF,cAAAA,UAAS,IAAI,GAC/C,CAACG,GAAkBC,CAAmB,QAAIJ,cAAAA,UAAS,KAAK,GACxD,CAACK,GAAmBC,CAAoB,QAAIN,cAAAA,UAAiD,IAAI,GACjG,CAACO,GAAiBC,CAAkB,QAAIR,cAAAA,UAAiB,eAAe,GACxES,QAAqBC,cAAAA,QAA8B,oBAAI,KAAK,GAE5DC,QAAaC,cAAAA,aAAY,MAAMd,uBAAU,cAAc,CAACA,CAAQ,CAAC;AAEvE,aAAAe,cAAAA,WAAU,MAAM;AACZ,QAAMC,IAAU,OAAO,EACnB,kBAAAnB,GACA,SAAAP,GACA,WAAAC,GACA,YAAAO,EACJ,MAAmD;AAC/C,UAAIP,GAAW;AACX,YAAM0B,IAAU,MAAe,GAAQ,SAAS,EAAE,YAAY1B,GAAW,OAAAE,EAAM,CAAC;AAChF,YAAI,CAACwB,EACD,OAAM,IAAI,MAAM,YAAY1B,CAAS,yBAAyBD,CAAO,GAAG;AAE5E,eAAO4B,GAAiB,KAAK,EAAE,SAAAD,EAAQ,CAAC;MAC5C;AAEA,UAAI3B,EACA,QAAIO,IACOqB,GAAiB,cAAc,EAAE,UAAU5B,GAAS,OAAAG,GAAO,cAAcD,EAAY,CAAC,IAEtF0B,GAAiB,MAAM,EAAE,UAAU5B,GAAS,OAAAG,GAAO,cAAcD,EAAY,CAAC;AAI7F,UAAIM,MAAe,SAAS;AACxB,YAAMmB,IAAU,MAAe,GAAQ,iBAAiB,EAAE,aAAaxB,EAAM,CAAC;AAC9E,YAAI,CAACwB,EACD,OAAM,IAAI,MAAM,yCAAyCxB,CAAK,GAAG;AAGrE,eAAOyB,GAAiB,KAAK,EAAE,SAAAD,EAAQ,CAAC;MAC5C;AAEA,YAAM,IAAI,MAAM,0BAA0B;IAC9C,GASME,IAAgCC,OAAkE;AACpG,UAAMC,IAAMC,GAAwBF,CAAM,GACtCG,IAAUZ,EAAmB,QAAQ,IAAIU,CAAG;AAChD,aAAKE,MACDA,IAAUP,EAAQI,CAAM,EAAE,KAAKpB,QAC3BW,EAAmB,QAAQ,OAAOU,CAAG,GAC9BrB,EACV,GACDW,EAAmB,QAAQ,IAAIU,GAAKE,CAAO,IAExCA;IACX,GAKMC,IAAmB,IAAI,mBAEvBC,IAAqB,MAAY;AACnCjB,QAAqB,IAAI;IAC7B;AAEA,WAAAW,EAA6B,EACzB,kBAAAtB,GACA,SAAAP,GACA,WAAAC,GACA,OAAAE,GACA,YAAAK,EACJ,CAA8B,EACzB,KAAKE,OAAY;AAEVwB,QAAiB,OAAO,YAK5BE,GAAgB1B,CAAQ,GACxBC,EAAYD,CAAQ,GACpBA,EAAS,4BAA4B,YAAY;AAC7CA,UAAS,eAAe,GACxBI,EAAgB,KAAK;MACzB,CAAC,GAEDJ,EAAS,QAAQ,iBAAiB,yBAAyBQ,CAAoB,GAC/ER,EAAS,QAAQ,iBAAiB,wBAAwByB,CAAkB;IAChF,CAAC,EACA,MAAME,OAAS;AAEZvB,QAAgB,KAAK,GACrBE,EAAoB,IAAI,GACxBI,EAAmBiB,CAAK;IAC5B,CAAC,GAEE,MAAY;AACfH,QAAiB,MAAM,GAEvBxB,uBAAU,QAAQ,oBAAoB,yBAAyBQ,IAC/DR,uBAAU,QAAQ,oBAAoB,wBAAwByB,IAE9DxB,EAAY,IAAI,GAChBG,EAAgB,IAAI,GACpBE,EAAoB,KAAK,GACzBE,EAAqB,IAAI;IAC7B;EACJ,GAAG,CAACf,GAAOI,GAAkBP,GAASC,GAAWC,GAAaM,CAAU,CAAC,OAEzEiB,cAAAA,WAAU,MAAM;AACZ,QAAI,CAACf,EACD;AAQJ,QAAM4B,IAAyBC,OAA4C;AACvEvB,QAAoB,IAAI,GACxBE,EAAqB,IAAI,GACzBE,EAAmBmB,EAAM,MAAM;IACnC;AAEA,WAAA7B,EAAS,QAAQ,iBAAiB,mBAAmB4B,CAAqB,GAEnE,MAAY;AACf5B,QAAS,QAAQ,oBAAoB,mBAAmB4B,CAAqB;IACjF;EACJ,GAAG,CAAC5B,CAAQ,CAAC,OAGbe,cAAAA,WAAU,MACC,MAAY;AACff,2BAAU;EACd,GACD,CAACA,CAAQ,CAAC,GAGT8B,cAAAA,QAAA,cAAC3C,EAAgB,UAAhB,EACG,OAAO,EACH,UAAAa,GACA,cAAAG,GACA,gBAAgBE,GAChB,YAAAQ,EACJ,EAAA,GAECV,KAAgBT,KAAgBoC,cAAAA,QAAA,cAACpC,GAAA,EAAa,OAAO,GAAA,CAAI,GACzDW,KAAoBT,KAAwBkC,cAAAA,QAAA,cAAClC,GAAA,EAAqB,OAAOa,EAAAA,CAAiB,GAC1FF,KAAqBZ,KAClBmC,cAAAA,QAAA,cAACnC,GAAA,EACG,iBAAiBY,EAAkB,mBACnC,oBAAoB,MAAM;AACtBA,MAAkB,WAAW,GAC7BC,EAAqB,IAAI;EAC7B,EAAA,CACJ,GAEHT,CACL;AAER;AAGA,SAAS2B,GAAgB1B,GAAkC;AACvD,MAAM+B,IAAY,YAA2B;AACzC/B,MAAS,QAAQ,oBAAoB,8BAA8B+B,CAAS;AAG5E,QAAMC,IAAW,MAAe,GAAiB,mBAAmB;AACpE,UAAMhC,EAAS,sBAAsB,EAAE,OAAOgC,KAAY,OAAU,CAAC,GAErE,MAAMhC,EAAS,wBAAwB,EACnC,wBACIgC,MAAa,OACP,IAAa,GAAiB,EAAE,wBAAwBhC,EAAS,+BAA+B,CAAC,IACjG,IAAa,GAAgB,EAAE,wBAAwBA,EAAS,+BAA+B,CAAC,EAC9G,CAAC,GAEDA,EAAS,wBAAwB;EACrC;AAEAA,IAAS,QAAQ,iBAAiB,8BAA8B+B,CAAS;AAC7E;AAGA,SAAST,GAAwBF,GAA2C;AACxE,SAAO,KAAK,UAAUA,CAAM;AAChC;ADzRO,SAASa,GACZC,GACAC,IAAkD,CAAC,GAIrD;AACE,MAAM,EAAE,UAAAnC,EAAS,QAAIoC,aAAAA,YAAWjD,CAAe,GAEzC,CAACkD,GAAQC,CAAS,QAAIpC,aAAAA,UAAwB,IAAI,GAClD,CAACqC,GAAWC,CAAY,QAAItC,aAAAA,UAAS,IAAI,GACzC,CAAC,EAAEuC,CAAW,QAAIC,aAAAA,YAAWC,OAAKA,IAAI,GAAG,CAAC,GAE1CC,IAAkBV;AAQxB,aAAAnB,aAAAA,WAAU,MACDf,MAIiB,YACd,gBAAgBkC,IAET,MAAMlC,EAAS,MAAM,UAAUkC,CAAc,IAC7C,aAAaU,IACb,MAAM5C,EAAS,MAAM,WAAW,EACnC,aAAa4C,EAAgB,MAC7B,SAASA,EAAgB,QAC7B,CAAC,IACM,UAAUA,KACT,MAAM5C,EAAS,MAAM,aAAa,EAAE,aAAa4C,EAAgB,KAAM,CAAC,GAAG,CAAC,IAC7E,UAAUA,KAAmBA,EAAgB,QAC5C,MAAM5C,EAAS,MAAM,oBAAoB,EAAE,cAAc,CAAC4C,EAAgB,IAAI,EAAE,CAAC,GAAG,CAAC,IACtF,0BAA0BA,KAE7B,MAAM5C,EAAS,MAAM,2BAA2B,EAC5C,sBAAsB4C,EAAgB,sBACtC,sBAAsBA,EAAgB,qBAC1C,CAAC,GACH,CAAC,IAEA,MAGG,EACT,KAAKC,OAAeP,EAAUO,CAAW,CAAC,EAC1C,QAAQ,MAAML,EAAa,KAAK,CAAC,GAE/B,MAAY;AACfF,MAAU,IAAI,GACdE,EAAa,IAAI;EACrB,KAlCI,QAmCL,CAACxC,GAAU,KAAK,UAAU4C,CAAe,CAAC,CAAC,OAE9C7B,aAAAA,WAAU,MAAM;AACZ,QAAM+B,IAAeX,MAAsB,OACrCY,IAAcZ,EAAkB,WAAW;AAEjD,QAAI,CAACE,KAAUU,EACX;AAGJ,QAAMC,IAAgBF,IAChBL,IACCZ,OAAoC;AAC7BA,QAAM,oBAAoB,EAAE,YAAYM,EAAkB,CAAC,KAC3DM,EAAY;IAEpB;AAEN,WAAAJ,EAAO,iBAAiB,qBAAqBW,CAAa,GAEnD,MAAY;AACfX,QAAO,oBAAoB,qBAAqBW,CAAa;IACjE;EACJ,GAAG,CAACX,GAAQF,CAAiB,CAAC,OAG9BpB,aAAAA,WAAU,MAAM;AACZ,QAAIsB,EAIJ,QAAAA,EAAO,iBAAiB,gCAAgCI,CAAW,GAC5D,MAAY;AACfJ,QAAO,oBAAoB,gCAAgCI,CAAW;IAC1E;EACJ,GAAG,CAACJ,CAAM,CAAC,GAEJ,EAAE,WAAAE,GAAW,QAAAF,EAAO;AAC/B;AErKO,SAASY,KAAyC;AACrD,MAAM,EAAE,UAAAjD,EAAS,QAAIoC,cAAAA,YAAWjD,CAAe,GAEzC,CAAC+D,GAASC,CAAU,QAAIjD,cAAAA,UAAwB,CAAC,CAAC;AAExD,aAAAa,cAAAA,WAAU,MAAM;AACZ,QAAI,CAACf,EACD;AAGJ,QAAMoD,IAAmB,MAAYD,EAAWnD,EAAS,QAAQ,aAAa;AAE9E,WAAAA,EAAS,QAAQ,iBAAiB,oBAAoBoD,CAAgB,GACtEpD,EAAS,QAAQ,iBAAiB,kBAAkBoD,CAAgB,GAEpEA,EAAiB,GAEV,MAAY;AACfpD,QAAS,QAAQ,oBAAoB,oBAAoBoD,CAAgB,GACzEpD,EAAS,QAAQ,oBAAoB,kBAAkBoD,CAAgB,GACvED,EAAW,CAAC,CAAC;IACjB;EACJ,GAAG,CAACnD,CAAQ,CAAC,GAEN,EAAE,SAAAkD,EAAQ;AACrB;ACyDO,SAASG,GACZC,IAA8B,CAAC,GAC/BnB,IAAkD,CAAC,GAIrD;AACE,MAAM,EACF,MAAAoB,IAAO,UACP,UAAAC,IAAW,CAAC,GAAG,GAAG,CAAC,GACnB,aAAaC,IAAe,CAAC,GAAG,GAAG,GAAG,CAAC,GACvC,kBAAkBC,IAAoB,CAAC,GAAG,GAAG,CAAC,GAC9C,gBAAAC,IAAiB,wCACjB,UAAAC,IAAW,EAAE,MAAM,MAAM,QAAQ,OAAO,UAAU,KAAK,GACvD,mBAAAC,IAAoB,IACpB,kBAAkBC,IAAoB,EAAE,MAAM,IAAI,WAAW,KAAK,UAAU,IAAM,EACtF,IAAIR,GAEES,IAAc,iBAAiBT,IAAQG,IAAe,QACtDO,IAAmB,CAACD,KAAe,sBAAsBT,IAAQI,IAAoB,QAErFO,IAAoB,uBAAuBX,IAAQA,EAAM,oBAAoB,QAC7EY,IAAoBD,IAAwC,SAApBH,GAExC,EAAE,WAAAvB,GAAW,QAAQ4B,EAAa,IAAIlC,GACxC,EACI,MAAAsB,GACA,YAAY,EACR,iBAAiB,EAAE,UAAAC,GAAU,aAAAO,GAAa,kBAAAC,EAAiB,GAC3D,QAAQ,EAAE,gBAAAL,GAAgB,UAAUC,GAAU,mBAAAC,EAAkB,GAChE,kBAAAK,GACA,mBAAAD,EACJ,GACA,SAAS,EAAE,gBAAgB,OAAO,gCAAgC,KAAK,EAC3E,GACA9B,CACJ;AAEA,SAAO,EAAE,WAAAI,GAAW,cAAA4B,EAAa;AACrC;AC5GO,IAAMC,QAAgBhF,cAAAA,eAG1B,EACC,QAAQ,MACR,kBAAkB,KACtB,CAAC;AA+BM,SAASiF,GAAO,EACnB,UAAAtE,GACA,aAAAuE,IAAc,MACd,mBAAAC,GACA,OAAAC,GACA,QAAAC,GACA,GAAGnB,EACP,GAA8E;AAC1E,MAAM,EAAE,UAAAtD,EAAS,QAAIoC,cAAAA,YAAWjD,CAAe,GACzC,EAAE,QAAQuF,EAAa,QAAItC,cAAAA,YAAWgC,CAAa,GAEnD,CAACO,GAAkBC,CAAmB,QAAI1E,cAAAA,UAAkC,IAAI,GAChF2E,QAAYjE,cAAAA,QAA0B,IAAI;AAEhD,aAAAG,cAAAA,WAAU,MAAM;AACZ,QAAI,CAACf,KAAY,CAAC6E,EAAU,QACxB;AAKJ,QAAMC,IAAOD,EAAU,QAAQ,sBAAsB;AACrD,QAAI,CAACC,EAAK,SAAS,CAACA,EAAK,QAAQ;AAC7B,cAAQ,MACJ,yCAAyCA,EAAK,KAAK,MAAMA,EAAK,MAAM,oDACpED,EAAU,OACd;AACA;IACJ;AAEA,QAAME,IAAU,IAAIC,GAAiB,EACjC,gBAAgBH,EAAU,SAC1B,cAAcP,GACd,oBAAoBC,EACxB,CAAC;AAED,WAAAK,EAAoBG,CAAO,GAEpB,MAAY;AAEfA,QAAQ,QAAQ,GAChBH,EAAoB,IAAI;IAC5B;EACJ,GAAG,CAAC5E,GAAUsE,GAAaC,CAAiB,CAAC,GAGzCzC,cAAAA,QAAA,cAACsC,EAAc,UAAd,EAAuB,OAAO,EAAE,QAAQS,EAAU,SAAS,kBAAAF,EAAiB,EAAA,GACzE7C,cAAAA,QAAA,cAAC,OAAA,EACG,aAAU,oBACV,OAAOmD,GAA4B,EAAE,cAAAP,GAAc,OAAAF,GAAO,QAAAC,EAAO,CAAC,GACjE,GAAGnB,EAAAA,GAEJxB,cAAAA,QAAA,cAAC,UAAA,EACG,KAAK+C,GACL,OAAO,EACH,UAAU,YACV,OAAO,QACP,QAAQ,QACR,eAAe,OACnB,EAAA,CACJ,GACC9E,CACL,CACJ;AAER;AAGA,SAASkF,GAA4B,EACjC,cAAAP,GACA,OAAAF,GACA,QAAAC,EACJ,GAIkB;AASd,SAAO,EAAE,GAPW,EAAE,UAAU,OAAO,GAOd,GARF,CAAA,CAAQC,IAEL,EAAE,UAAU,YAAY,OAAAF,GAAO,QAAAC,EAAO,IACxC,EACpB,UAAU,YACV,OAAOD,KAAS,QAChB,QAAQC,KAAU,OACtB,EACmF;AACvF;ACzHO,IAAMS,QAAkB9F,cAAAA,eAK5B,EACC,UAAU,MACV,oBAAoB,MACpB,QAAQ,GACR,QAAQ,KACZ,CAAC;AAVM,IAiBM+F,SAAWC,cAAAA,YAAW,SAC/B,EACI,kBAAAC,GACA,iBAAAC,GACA,mBAAAzB,IAAoB,IACpB,UAAA9D,GACA,GAAGuD,EACP,GAmBAiC,GACW;AACX,MAAM,EAAE,cAAApB,GAAc,QAAAqB,GAAQ,aAAAC,GAAa,GAAGC,EAAW,IAAIpC,GAOvD,EAAE,UAAAtD,EAAS,QAAIoC,cAAAA,YAAWjD,CAAe,GACzC,EAAE,kBAAAwF,GAAkB,QAAAgB,EAAO,QAAIvD,cAAAA,YAAWgC,CAAa,GACvD,EAAE,QAAQwB,IAAe,EAAE,QAAIxD,cAAAA,YAAW8C,CAAe,GAGzD,CAACW,GAAUC,CAAW,QAAI5F,cAAAA,UAAmC,IAAI,GACjE,CAAC6F,GAAoBC,CAAqB,QAAI9F,cAAAA,UAAiC,IAAI,GACnF,CAAC+F,GAAQC,CAAS,QAAIhG,cAAAA,UAA2C,IAAI,GACrEiG,QAAqBvF,cAAAA,QAAuB,IAAI;AAGtDwF,oBAAAA,qBAAoBb,GAAK,MAAMM,KAAY,QAAW,CAACA,CAAQ,CAAC;AAGhE,MAAMQ,QAAWvF,cAAAA,aAAY,MAAM;AAC3B,KAACqF,EAAmB,WAAW,CAACR,KAAU,CAACE,MAIPM,EAAmB,SAC3DN,EAAS,gBAAyB,GAAa,kBAAkB,EAC7D,SAASM,EAAmB,SAC5B,QAAQR,EACZ,CAAC;EACL,GAAG,CAACE,GAAUF,GAAQQ,EAAmB,OAAO,CAAC;AAGjDpF,oBAAAA,WAAU,MAAM;AACZ,QAAI,CAACoF,EAAmB,QACpB;AAGJ,QAAMG,IAAiB,IAAI,eAAeD,CAAQ;AAClD,WAAAC,EAAe,QAAQH,EAAmB,OAAO,GAC1C,MAAY;AACfG,QAAe,WAAW;IAC9B;EACJ,GAAG,CAACH,EAAmB,SAASE,CAAQ,CAAC,OAGzCtF,cAAAA,WAAU,MAAM;AACZ,QAAK4D,EAIL,QAAAA,EAAiB,iBAAiB,gCAAgC0B,CAAQ,GACnE,MAAY;AACf1B,QAAiB,oBAAoB,gCAAgC0B,CAAQ;IACjF;EACJ,GAAG,CAAC1B,GAAkB0B,CAAQ,CAAC;AAG/B,MAAME,IAASX,IAAe;AAC9B,aAAA7E,cAAAA,WAAU,MAAM;AACZ,QAAI,EAAA,CAACf,KAAY,CAAC2E,KAAoB,CAACgB,KAAU,CAACQ,EAAmB,SAIrE,KAAI;AACA,UAAMrB,IAAgB,GAAa,kBAAkB,EACjD,SAASqB,EAAmB,SAC5B,QAAQR,EACZ,CAAC,GAEKE,IAAW,IAAa,GAAS,EACnC,MAAM7F,GACN,mBAAmB2E,GACnB,SAAS,EACL,MAAAG,GACA,SAASyB,GACT,qBAAqB1C,GACrB,aAAasC,EAAmB,QACpC,EACJ,CAAC;AAED,aAAuCN,EAAS,OAAOA,EAAS,QAChE7F,EAAS,aAAa,EAAE,WAAW,CAAC6F,CAAQ,EAAE,CAAC,GAC/CC,EAAYD,CAAQ,GAEb,MAAY;AAEf7F,UAAS,eAAe,EAAE,UAAA6F,EAAS,CAAC,GACpCA,EAAS,QAAQ,GACjBC,EAAY,IAAI;MACpB;IACJ,SAASnE,GAAO;AACRA,mBAA0B,KAC1B,QAAQ,MACJ,8DACAwE,EAAmB,SACnBR,CACJ,IACOhE,aAA0B,KACjC,QAAQ,MACJ,2CAA2CA,EAAM,KAAK,KAAK,MAAMA,EAAM,KAAK,MAAM,MAClFgE,CACJ,IAEA,QAAQ,MAAM,4BAA4BQ,EAAmB,SAASxE,CAAK;IAEnF;EACJ,GAAG,CAAC3B,GAAU2E,GAAkBgB,GAAQY,CAAM,CAAC,OAG/CxF,cAAAA,WAAU,MAAM;AACRyE,QACAA,EAAO,kBAAkB,EAAE,KAAKgB,OAAkB;AAC9CR,QAAsBQ,EAAef,KAAe,CAAC,CAAC;IAC1D,CAAC,IAEDO,EAAsB7B,KAAgB,IAAI;EAElD,GAAG,CAACA,GAAcqB,GAAQC,CAAW,CAAC,OAGtC1E,cAAAA,WAAU,MAAM;AACR,KAAC8E,KAAY,CAACE,MAKlBF,EAAS,oBAAoB,IAAa,GAAiB,EAAE,eAAeE,GAAoB,UAAAF,EAAS,CAAC,GAC1GK,EAAUL,EAAS,iBAAiB;EACxC,GAAG,CAACA,GAAUE,CAAkB,CAAC,OAGjChF,cAAAA,WAAU,MAAM;AACZ,QAAI,CAAC8E,EACD;AAGJ,QAAMY,IAAkBC,OACpBpB,uBACIoB,EAAE,iBAAiBA,EAAE,eAAeA,EAAE,YAChC,EAAE,QAAQA,EAAE,eAAe,aAAaA,EAAE,aAAa,WAAWA,EAAE,UAAU,IAC9E;AAEVpB,UACAO,EAAS,gBAAgB,GACzBA,EAAS,iBAAiB,oBAAoBY,CAAc;AAGhE,QAAME,IAAmBD,OACrBrB,uBACIqB,EAAE,kBAAkBA,EAAE,eAAeA,EAAE,YACjC,EAAE,QAAQA,EAAE,gBAAgB,aAAaA,EAAE,aAAa,WAAWA,EAAE,UAAU,IAC/E;AAEd,WAAIrB,MACAQ,EAAS,iBAAiB,GAC1BA,EAAS,iBAAiB,qBAAqBc,CAAe,IAG3D,MAAY;AACXrB,YACAO,EAAS,oBAAoB,oBAAoBY,CAAc,GAC/DZ,EAAS,kBAAkB,IAG3BR,MACAQ,EAAS,oBAAoB,qBAAqBc,CAAe,GACjEd,EAAS,mBAAmB;IAEpC;EACJ,GAAG,CAACA,GAAUP,GAAiBD,CAAgB,CAAC,GAI5CvD,cAAAA,QAAA,cAACoD,EAAgB,UAAhB,EACG,OAAO,EACH,UAAAW,GACA,oBAAoBM,EAAmB,SACvC,QAAAI,GACA,QAAQN,EACZ,EAAA,GAEAnE,cAAAA,QAAA,cAAC,OAAA,EAAI,KAAKqE,GAAoB,aAAU,YAAY,GAAGT,EAAAA,GAClD3F,CACL,CACJ;AAER,CAAC;AC3OM,IAAM6G,SAA0BxH,cAAAA,eAEpC,EACC,kBAAkB,OACtB,CAAC;AAJM,IAWMyH,SAAmBzB,cAAAA,YAAW,SACvC,EAAE,QAAA0B,IAASC,GAAwB,SAAS,UAAAhH,EAAS,GACrDwF,GACF;AACE,MAAM,EAAE,UAAAM,GAAU,QAAAI,EAAO,QAAI7D,cAAAA,YAAW8C,CAAe,GACjD,CAAC8B,GAAkBC,CAAmB,QAAI/G,cAAAA,UAA8C,MAAS;AACvG,aAAAkG,cAAAA,qBAAoBb,GAAK,MAAMyB,GAAkB,CAACA,CAAgB,CAAC,OAEnEjG,cAAAA,WAAU,MAAM;AACZ,QAAI,CAAC8E,KAAY,CAACI,EACd;AAGJ,QAAMiB,IAAa,IAAIC,GAAwB,EAC3C,eAAelB,EAAO,eACtB,UAAAJ,GACA,QAAAiB,EACJ,CAAC;AAED,WAAAG,EAAoBC,CAAU,GAEvB,MAAY;AACfA,QAAW,QAAQ,GACnBD,EAAoB,MAAS;IACjC;EACJ,GAAG,CAACpB,GAAUI,GAAQa,CAAM,CAAC,GAEtBhF,cAAAA,QAAA,cAAC8E,GAAwB,UAAxB,EAAiC,OAAO,EAAE,kBAAAI,EAAiB,EAAA,GAAIjH,CAAS;AACpF,CAAC;ACxDM,SAASqH,GAAS,EACrB,aAAAC,IAAc,EACV,aAAa,mBACb,QAAQ,EACJ,cAAc,CAAC,OAAO,EAC1B,EACJ,GACA,iBAAAC,IAAkB,EACd,UAAU,4BACV,oBAAoB,IACxB,GACA,eAAAC,IAAgB,EACZ,kBAAkB,GACtB,GACA,UAAAxH,EACJ,GAKc;AACV,MAAM,EAAE,kBAAA4E,EAAiB,QAAIvC,cAAAA,YAAWgC,CAAa,GAC/C,CAACoD,GAAYC,CAAa,QAAIvH,cAAAA,UAAS,CAAC,GACxC,CAACwH,GAAaC,CAAc,QAAIzH,cAAAA,UAAS,KAAK,GAE9C0H,QAAgBC,cAAAA,SAAQ,MAAM;AAChC,QAAI,CAAClD,EACD,QAAO;AAGX,QAAMmD,IAASnD,EAAiB,OAAO,cAAc4C,EAAc,gBAAgB;AACnF,WAAO,IAAI,cAAcO,GAAQR,CAAe;EACpD,GAAG,CAAC3C,CAAgB,CAAC;AAErB,aAAA5D,cAAAA,WAAU,MAAM;AACZ,QAAK6G,EAIL,QAAA,OAAO,mBAAmB,EAAE,OAAO,CAACP,CAAW,EAAE,CAAC,EAAE,KAAK,OAAOU,MAAqC;AACjG,UAAMC,IAA2C,MAAMD,EAAW,eAAe;AACjFH,QAAc,kBAAmB/F,OAA2B;AACpDA,UAAM,KAAK,OAAO,KAClBmG,EAAW,MAAMnG,EAAM,IAAI;MAEnC,GACA+F,EAAc,SAAS,MAAY;AAC/BI,UAAW,MAAM;MACrB,GACAJ,EAAc,MAAM,GACpBD,EAAe,IAAI;IACvB,CAAC,GAEM,MAAY;AACfC,QAAc,KAAK;IACvB;EACJ,GAAG,CAACA,CAAa,CAAC,OAElB7G,cAAAA,WAAU,MAAM;AACZ,QAAI,CAAC2G,EACD;AAGJ,QAAMO,IAAW,YAAY,MAAM;AAC/BR,QAAeS,OAAiBA,IAAO,CAAC;IAC5C,GAAG,GAAI;AAEP,WAAO,MAAY,cAAcD,CAAQ;EAC7C,GAAG,CAACP,CAAW,CAAC,GAET5F,cAAAA,QAAA,cAAAA,cAAAA,QAAA,UAAA,MAAG/B,IAAWA,EAAS,EAAE,YAAAyH,EAAW,CAAC,IAAI,IAAK;AACzD;AI5EO,IAAIW,IAAU;AAAd,IACIC,IAAa,OAAO,eAAiB,MAAc,eAAe;AADtE,IAEIC,IAAS,KAAK;AAUzB,IAAIC,KAAS,KAAK,KAAK;AAuBlB,KAAK,UAAO,KAAK,QAAQ,WAAY;AAIxC,WAHIC,IAAI,GACJC,IAAI,UAAU,QAEXA,MACLD,MAAK,UAAUC,CAAC,IAAI,UAAUA,CAAC;AAGjC,SAAO,KAAK,KAAKD,CAAC;AACpB;ACjDA,IAAAE,IAAA,CAAA;AAAAC,GAAAD,GAAA,EAAA,KAAA,MAAAE,IAAA,OAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,MAAA,MAAAC,IAAA,OAAA,MAAAC,IAAA,MAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,OAAA,MAAAC,IAAA,MAAA,MAAAC,IAAA,UAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,aAAA,MAAAC,IAAA,OAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,YAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,MAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,UAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,WAAA,MAAAC,IAAA,QAAA,MAAAC,KAAA,SAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,OAAA,MAAAC,IAAA,OAAA,MAAAC,KAAA,aAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,SAAA,MAAAC,IAAA,QAAA,MAAAC,IAAA,iBAAA,MAAAC,IAAA,eAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,KAAA,MAAAC,IAAA,UAAA,MAAAC,IAAA,eAAA,MAAAC,IAAA,eAAA,MAAAC,IAAA,eAAA,MAAAC,IAAA,MAAA,MAAAC,GAAAA,CAAAA;AAYO,SAASzC,KAAS;AACvB,MAAI0C,IAAM,IAAavD,EAAW,CAAC;AAEnC,SAAaA,KAAc,iBACzBuD,EAAI,CAAC,IAAI,GACTA,EAAI,CAAC,IAAI,GACTA,EAAI,CAAC,IAAI,IAGJA;AACT;AAQO,SAAS5C,GAAM6C,GAAG;AACvB,MAAID,IAAM,IAAavD,EAAW,CAAC;AACnC,SAAAuD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACZD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACZD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACLD;AACT;AAQO,SAAS3B,GAAO4B,GAAG;AACxB,MAAIjJ,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC;AACX,SAAO,KAAK,MAAMjJ,GAAG4F,GAAGsD,CAAC;AAC3B;AAUO,SAASjC,GAAWjH,GAAG4F,GAAGsD,GAAG;AAClC,MAAIF,IAAM,IAAavD,EAAW,CAAC;AACnC,SAAAuD,EAAI,CAAC,IAAIhJ,GACTgJ,EAAI,CAAC,IAAIpD,GACToD,EAAI,CAAC,IAAIE,GACFF;AACT;AASO,SAAS3C,GAAK2C,GAAKC,GAAG;AAC3B,SAAAD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACZD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACZD,EAAI,CAAC,IAAIC,EAAE,CAAC,GACLD;AACT;AAWO,SAASZ,GAAIY,GAAKhJ,GAAG4F,GAAGsD,GAAG;AAChC,SAAAF,EAAI,CAAC,IAAIhJ,GACTgJ,EAAI,CAAC,IAAIpD,GACToD,EAAI,CAAC,IAAIE,GACFF;AACT;AAUO,SAAShD,GAAIgD,GAAKC,GAAGE,GAAG;AAC7B,SAAAH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACZH;AACT;AAUO,SAASL,GAASK,GAAKC,GAAGE,GAAG;AAClC,SAAAH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACZH;AACT;AAUO,SAAStB,GAASsB,GAAKC,GAAGE,GAAG;AAClC,SAAAH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACZH;AACT;AAUO,SAASrC,GAAOqC,GAAKC,GAAGE,GAAG;AAChC,SAAAH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACZH;AACT;AASO,SAAS7C,GAAK6C,GAAKC,GAAG;AAC3B,SAAAD,EAAI,CAAC,IAAI,KAAK,KAAKC,EAAE,CAAC,CAAC,GACvBD,EAAI,CAAC,IAAI,KAAK,KAAKC,EAAE,CAAC,CAAC,GACvBD,EAAI,CAAC,IAAI,KAAK,KAAKC,EAAE,CAAC,CAAC,GAChBD;AACT;AASO,SAASjC,GAAMiC,GAAKC,GAAG;AAC5B,SAAAD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACxBD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACxBD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACjBD;AACT;AAUO,SAASxB,GAAIwB,GAAKC,GAAGE,GAAG;AAC7B,SAAAH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GAC5BH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GAC5BH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GACrBH;AACT;AAUO,SAASzB,GAAIyB,GAAKC,GAAGE,GAAG;AAC7B,SAAAH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GAC5BH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GAC5BH,EAAI,CAAC,IAAI,KAAK,IAAIC,EAAE,CAAC,GAAGE,EAAE,CAAC,CAAC,GACrBH;AACT;AASO,SAASf,GAAMe,GAAKC,GAAG;AAC5B,SAAAD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACxBD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACxBD,EAAI,CAAC,IAAI,KAAK,MAAMC,EAAE,CAAC,CAAC,GACjBD;AACT;AAUO,SAASd,IAAMc,GAAKC,GAAGE,GAAG;AAC/B,SAAAH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,GAChBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,GAChBH,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,GACTH;AACT;AAWO,SAASb,GAAYa,GAAKC,GAAGE,GAAGjB,GAAO;AAC5C,SAAAc,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,IAAIjB,GACvBc,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,IAAIjB,GACvBc,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIE,EAAE,CAAC,IAAIjB,GAChBc;AACT;AASO,SAASvC,GAASwC,GAAGE,GAAG;AAC7B,MAAInJ,IAAImJ,EAAE,CAAC,IAAIF,EAAE,CAAC,GACdrD,IAAIuD,EAAE,CAAC,IAAIF,EAAE,CAAC,GACdC,IAAIC,EAAE,CAAC,IAAIF,EAAE,CAAC;AAClB,SAAO,KAAK,MAAMjJ,GAAG4F,GAAGsD,CAAC;AAC3B;AASO,SAASX,GAAgBU,GAAGE,GAAG;AACpC,MAAInJ,IAAImJ,EAAE,CAAC,IAAIF,EAAE,CAAC,GACdrD,IAAIuD,EAAE,CAAC,IAAIF,EAAE,CAAC,GACdC,IAAIC,EAAE,CAAC,IAAIF,EAAE,CAAC;AAClB,SAAOjJ,IAAIA,IAAI4F,IAAIA,IAAIsD,IAAIA;AAC7B;AAQO,SAASV,GAAcS,GAAG;AAC/B,MAAIjJ,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC;AACX,SAAOjJ,IAAIA,IAAI4F,IAAIA,IAAIsD,IAAIA;AAC7B;AASO,SAASvB,GAAOqB,GAAKC,GAAG;AAC7B,SAAAD,EAAI,CAAC,IAAI,CAACC,EAAE,CAAC,GACbD,EAAI,CAAC,IAAI,CAACC,EAAE,CAAC,GACbD,EAAI,CAAC,IAAI,CAACC,EAAE,CAAC,GACND;AACT;AASO,SAAS7B,GAAQ6B,GAAKC,GAAG;AAC9B,SAAAD,EAAI,CAAC,IAAI,IAAMC,EAAE,CAAC,GAClBD,EAAI,CAAC,IAAI,IAAMC,EAAE,CAAC,GAClBD,EAAI,CAAC,IAAI,IAAMC,EAAE,CAAC,GACXD;AACT;AASO,SAASpB,GAAUoB,GAAKC,GAAG;AAChC,MAAIjJ,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC,GACP7B,IAAMpH,IAAIA,IAAI4F,IAAIA,IAAIsD,IAAIA;AAE9B,SAAI9B,IAAM,MAERA,IAAM,IAAI,KAAK,KAAKA,CAAG,IAGzB4B,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAI7B,GAChB4B,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAI7B,GAChB4B,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAI7B,GACT4B;AACT;AASO,SAASpC,GAAIqC,GAAGE,GAAG;AACxB,SAAOF,EAAE,CAAC,IAAIE,EAAE,CAAC,IAAIF,EAAE,CAAC,IAAIE,EAAE,CAAC,IAAIF,EAAE,CAAC,IAAIE,EAAE,CAAC;AAC/C;AAUO,SAAS5C,GAAMyC,GAAKC,GAAGE,GAAG;AAC/B,MAAIC,IAAKH,EAAE,CAAC,GACRI,IAAKJ,EAAE,CAAC,GACRK,IAAKL,EAAE,CAAC,GACRM,IAAKJ,EAAE,CAAC,GACRK,IAAKL,EAAE,CAAC,GACRM,IAAKN,EAAE,CAAC;AACZ,SAAAH,EAAI,CAAC,IAAIK,IAAKI,IAAKH,IAAKE,GACxBR,EAAI,CAAC,IAAIM,IAAKC,IAAKH,IAAKK,GACxBT,EAAI,CAAC,IAAII,IAAKI,IAAKH,IAAKE,GACjBP;AACT;AAWO,SAAS1B,GAAK0B,GAAKC,GAAGE,GAAGO,GAAG;AACjC,MAAIN,IAAKH,EAAE,CAAC,GACRI,IAAKJ,EAAE,CAAC,GACRK,IAAKL,EAAE,CAAC;AACZ,SAAAD,EAAI,CAAC,IAAII,IAAKM,KAAKP,EAAE,CAAC,IAAIC,IAC1BJ,EAAI,CAAC,IAAIK,IAAKK,KAAKP,EAAE,CAAC,IAAIE,IAC1BL,EAAI,CAAC,IAAIM,IAAKI,KAAKP,EAAE,CAAC,IAAIG,IACnBN;AACT;AAaO,SAAS9B,GAAQ8B,GAAKC,GAAGE,GAAGQ,GAAGC,GAAGF,GAAG;AAC1C,MAAIG,IAAeH,IAAIA,GACnBI,IAAUD,KAAgB,IAAIH,IAAI,KAAK,GACvCK,IAAUF,KAAgBH,IAAI,KAAKA,GACnCM,IAAUH,KAAgBH,IAAI,IAC9BO,IAAUJ,KAAgB,IAAI,IAAIH;AACtC,SAAAV,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GACnEjB,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GACnEjB,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GAC5DjB;AACT;AAaO,SAAS9C,GAAO8C,GAAKC,GAAGE,GAAGQ,GAAGC,GAAGF,GAAG;AACzC,MAAIQ,IAAgB,IAAIR,GACpBS,IAAwBD,IAAgBA,GACxCL,IAAeH,IAAIA,GACnBI,IAAUK,IAAwBD,GAClCH,IAAU,IAAIL,IAAIS,GAClBH,IAAU,IAAIH,IAAeK,GAC7BD,IAAUJ,IAAeH;AAC7B,SAAAV,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GACnEjB,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GACnEjB,EAAI,CAAC,IAAIC,EAAE,CAAC,IAAIa,IAAUX,EAAE,CAAC,IAAIY,IAAUJ,EAAE,CAAC,IAAIK,IAAUJ,EAAE,CAAC,IAAIK,GAC5DjB;AACT;AASO,SAASnB,IAAOmB,GAAKd,GAAO;AACjCA,MAAQA,KAAS;AACjB,MAAIkC,IAAa1E,EAAO,IAAI,IAAM,KAAK,IACnCwD,IAAaxD,EAAO,IAAI,IAAM,GAC9B2E,IAAS,KAAK,KAAK,IAAMnB,IAAIA,CAAC,IAAIhB;AACtC,SAAAc,EAAI,CAAC,IAAI,KAAK,IAAIoB,CAAC,IAAIC,GACvBrB,EAAI,CAAC,IAAI,KAAK,IAAIoB,CAAC,IAAIC,GACvBrB,EAAI,CAAC,IAAIE,IAAIhB,GACNc;AACT;AAWO,SAASH,GAAcG,GAAKC,GAAGqB,GAAG;AACvC,MAAItK,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC,GACPsB,IAAID,EAAE,CAAC,IAAItK,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,EAAE,IAAIpB,IAAIoB,EAAE,EAAE;AAC9C,SAAAC,IAAIA,KAAK,GACTvB,EAAI,CAAC,KAAKsB,EAAE,CAAC,IAAItK,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,CAAC,IAAIpB,IAAIoB,EAAE,EAAE,KAAKC,GACpDvB,EAAI,CAAC,KAAKsB,EAAE,CAAC,IAAItK,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,CAAC,IAAIpB,IAAIoB,EAAE,EAAE,KAAKC,GACpDvB,EAAI,CAAC,KAAKsB,EAAE,CAAC,IAAItK,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,EAAE,IAAIpB,IAAIoB,EAAE,EAAE,KAAKC,GAC9CvB;AACT;AAUO,SAASJ,GAAcI,GAAKC,GAAGqB,GAAG;AACvC,MAAItK,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC;AACX,SAAAD,EAAI,CAAC,IAAIhJ,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,CAAC,IAAIpB,IAAIoB,EAAE,CAAC,GACtCtB,EAAI,CAAC,IAAIhJ,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,CAAC,IAAIpB,IAAIoB,EAAE,CAAC,GACtCtB,EAAI,CAAC,IAAIhJ,IAAIsK,EAAE,CAAC,IAAI1E,IAAI0E,EAAE,CAAC,IAAIpB,IAAIoB,EAAE,CAAC,GAC/BtB;AACT;AAWO,SAASF,GAAcE,GAAKC,GAAGuB,GAAG;AAEvC,MAAIC,IAAKD,EAAE,CAAC,GACRE,IAAKF,EAAE,CAAC,GACRG,IAAKH,EAAE,CAAC,GACRI,IAAKJ,EAAE,CAAC,GACRxK,IAAIiJ,EAAE,CAAC,GACPrD,IAAIqD,EAAE,CAAC,GACPC,IAAID,EAAE,CAAC,GAGP4B,IAAMH,IAAKxB,IAAIyB,IAAK/E,GACpBkF,IAAMH,IAAK3K,IAAIyK,IAAKvB,GACpB6B,IAAMN,IAAK7E,IAAI8E,IAAK1K,GAEpBgL,IAAON,IAAKK,IAAMJ,IAAKG,GACvBG,IAAON,IAAKE,IAAMJ,IAAKM,GACvBG,IAAOT,IAAKK,IAAMJ,IAAKG,GAEvBM,IAAKP,IAAK;AACd,SAAAC,KAAOM,GACPL,KAAOK,GACPJ,KAAOI,GAEPH,KAAQ,GACRC,KAAQ,GACRC,KAAQ,GAERlC,EAAI,CAAC,IAAIhJ,IAAI6K,IAAMG,GACnBhC,EAAI,CAAC,IAAIpD,IAAIkF,IAAMG,GACnBjC,EAAI,CAAC,IAAIE,IAAI6B,IAAMG,GACZlC;AACT;AAUO,SAASlB,GAAQkB,GAAKC,GAAGE,GAAGiC,GAAK;AACtC,MAAIC,IAAI,CAAC,GACLjB,IAAI,CAAC;AAET,SAAAiB,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GAEjBiB,EAAE,CAAC,IAAIiB,EAAE,CAAC,GACVjB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GACjDhB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GAEjDpC,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACZH;AACT;AAUO,SAASjB,GAAQiB,GAAKC,GAAGE,GAAGiC,GAAK;AACtC,MAAIC,IAAI,CAAC,GACLjB,IAAI,CAAC;AAET,SAAAiB,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GAEjBiB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GACjDhB,EAAE,CAAC,IAAIiB,EAAE,CAAC,GACVjB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GAEjDpC,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACZH;AACT;AAUO,SAAShB,GAAQgB,GAAKC,GAAGE,GAAGiC,GAAK;AACtC,MAAIC,IAAI,CAAC,GACLjB,IAAI,CAAC;AAET,SAAAiB,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GACjBkC,EAAE,CAAC,IAAIpC,EAAE,CAAC,IAAIE,EAAE,CAAC,GAEjBiB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GACjDhB,EAAE,CAAC,IAAIiB,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,IAAIC,EAAE,CAAC,IAAI,KAAK,IAAID,CAAG,GACjDhB,EAAE,CAAC,IAAIiB,EAAE,CAAC,GAEVrC,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACnBH,EAAI,CAAC,IAAIoB,EAAE,CAAC,IAAIjB,EAAE,CAAC,GACZH;AACT;AAQO,SAAS/C,GAAMgD,GAAGE,GAAG;AAC1B,MAAIC,IAAKH,EAAE,CAAC,GACRI,IAAKJ,EAAE,CAAC,GACRK,IAAKL,EAAE,CAAC,GACRM,IAAKJ,EAAE,CAAC,GACRK,IAAKL,EAAE,CAAC,GACRM,IAAKN,EAAE,CAAC,GACRmC,IAAO,KAAK,KAAKlC,IAAKA,IAAKC,IAAKA,IAAKC,IAAKA,CAAE,GAC5CiC,IAAO,KAAK,KAAKhC,IAAKA,IAAKC,IAAKA,IAAKC,IAAKA,CAAE,GAC5C+B,IAAMF,IAAOC,GACbE,IAASD,KAAO5E,GAAIqC,GAAGE,CAAC,IAAIqC;AAChC,SAAO,KAAK,KAAK,KAAK,IAAI,KAAK,IAAIC,GAAQ,EAAE,GAAG,CAAC,CAAC;AACpD;AAQO,SAAS1C,GAAKC,GAAK;AACxB,SAAAA,EAAI,CAAC,IAAI,GACTA,EAAI,CAAC,IAAI,GACTA,EAAI,CAAC,IAAI,GACFA;AACT;AAQO,SAASP,GAAIQ,GAAG;AACrB,SAAO,UAAUA,EAAE,CAAC,IAAI,OAAOA,EAAE,CAAC,IAAI,OAAOA,EAAE,CAAC,IAAI;AACtD;AASO,SAASnC,GAAYmC,GAAGE,GAAG;AAChC,SAAOF,EAAE,CAAC,MAAME,EAAE,CAAC,KAAKF,EAAE,CAAC,MAAME,EAAE,CAAC,KAAKF,EAAE,CAAC,MAAME,EAAE,CAAC;AACvD;AASO,SAAStC,GAAOoC,GAAGE,GAAG;AAC3B,MAAIuC,IAAKzC,EAAE,CAAC,GACR0C,IAAK1C,EAAE,CAAC,GACR2C,IAAK3C,EAAE,CAAC,GACR4C,IAAK1C,EAAE,CAAC,GACR2C,IAAK3C,EAAE,CAAC,GACR4C,IAAK5C,EAAE,CAAC;AACZ,SAAO,KAAK,IAAIuC,IAAKG,CAAE,KAAcrG,IAAU,KAAK,IAAI,GAAK,KAAK,IAAIkG,CAAE,GAAG,KAAK,IAAIG,CAAE,CAAC,KAAK,KAAK,IAAIF,IAAKG,CAAE,KAActG,IAAU,KAAK,IAAI,GAAK,KAAK,IAAImG,CAAE,GAAG,KAAK,IAAIG,CAAE,CAAC,KAAK,KAAK,IAAIF,IAAKG,CAAE,KAAcvG,IAAU,KAAK,IAAI,GAAK,KAAK,IAAIoG,CAAE,GAAG,KAAK,IAAIG,CAAE,CAAC;AACnQ;AAMO,IAAIrD,KAAMC;AAAV,IAMIlB,KAAMC;AANV,IAYIhB,KAAMC;AAZV,IAkBIH,KAAOC;AAlBX,IAwBI4B,KAAUE;AAxBd,IA8BInB,KAAMC;AA9BV,IAoCIiB,KAASE;AApCb,IAkDIxB,KAAU,WAAY;AAC/B,MAAIgF,IAAM1F,GAAO;AACjB,SAAO,SAAU2C,GAAGgD,GAAQC,GAAQC,GAAOC,GAAIC,GAAK;AAClD,QAAIxG,GAAG;AAgBP,SAdKoG,MACHA,IAAS,IAGNC,MACHA,IAAS,IAGPC,IACF,IAAI,KAAK,IAAIA,IAAQF,IAASC,GAAQjD,EAAE,MAAM,IAE9C,IAAIA,EAAE,QAGHpD,IAAIqG,GAAQrG,IAAI,GAAGA,KAAKoG,EAC3BD,GAAI,CAAC,IAAI/C,EAAEpD,CAAC,GACZmG,EAAI,CAAC,IAAI/C,EAAEpD,IAAI,CAAC,GAChBmG,EAAI,CAAC,IAAI/C,EAAEpD,IAAI,CAAC,GAChBuG,EAAGJ,GAAKA,GAAKK,CAAG,GAChBpD,EAAEpD,CAAC,IAAImG,EAAI,CAAC,GACZ/C,EAAEpD,IAAI,CAAC,IAAImG,EAAI,CAAC,GAChB/C,EAAEpD,IAAI,CAAC,IAAImG,EAAI,CAAC;AAGlB,WAAO/C;EACT;AACF,EAAE;AFxuBK,SAASqD,GAA4BC,GAA2E;AACnH,SAAQ5L,OACGxB,cAAAA,QAAA,cAACqN,GAAA,EAAe,SAASD,GAAU,GAAG5L,EAAAA,CAAO;AAE5D;;AAKO,IAAM6L,KAAN,mBAA6BrN,cAAAA,QAAM,UAGxC;EAHK;;;AAyBH,iCAAQ,EACJ,iBAAiB2G,EAAK,OAAO,GAC7B,SAAS,GACT,OAAO,GACP,YAAY,OACZ,aAAa,CAAC,GAAG,CAAC,EACtB;;EAKA,oBAA0B;AACtB,0BAAK2G,oBAAL,YACA,KAAK,MAAM,QAAQ,iBAAiB,IAAI;EAC5C;EAKA,mBACIC,GAKI;AAAA,KAEAA,EAAU,cAAc,KAAK,CAACC,GAAG9G,MAAM8G,MAAM,KAAK,MAAM,cAAc9G,CAAC,CAAC,KACxE6G,EAAU,WAAW,KAAK,MAAM,UAChCA,EAAU,gBAAgB,KAAK,MAAM,iBAErC,sBAAKD,oBAAL,YACA,KAAK,MAAM,QAAQ,eAAe;EAE1C;EASA,uBAA6B;AACzB,SAAK,MAAM,QAAQ,mBAAmB,IAAI;EAC9C;EAKA,IAAI,kBAAwB;AACxB,WAAO,KAAK,MAAM;EACtB;EAKA,IAAI,iBAAuB;AACvB,WAAO,KAAK,MAAM;EACtB;EAKA,IAAI,eAAmC;AACnC,WAAO,KAAK,MAAM;EACtB;EAKA,cAAcG,GAA+C;AACzD,SAAK,SAASA,CAAK;EACvB;EA6BA,SAAoB;AAChB,QAAI,CAAC,KAAK,MAAM,WACZ,QAAO;AAGX,QAAMC,IAAiB;wBACP,KAAK,MAAM,YAAY,CAAC,CAAC,MAAM,KAAK,MAAM,YAAY,CAAC,CAAC;wBACxD,KAAK,MAAM,gBAAgB,CAAC,CAAC,OAAO,KAAK,MAAM,gBAAgB,CAAC,CAAC;AAEjF,eAAOC,iBAAAA,cACH3N,cAAAA,QAAA,cAAC,OAAA,EACG,OAAO,EACH,UAAU,YACV,WAAW0N,GACX,QAAQ,KAAK,MAAM,SACnB,eAAe,OACnB,EAAA,GAEC,KAAK,eACF1N,cAAAA,QAAA,cAAC,OAAA,EAAI,OAAO,EAAE,WAAW,SAAS,KAAK,MAAM,KAAK,IAAI,EAAA,GAAI,KAAK,MAAM,QAAS,IAE9E,KAAK,MAAM,QAEnB,GACA,KAAK,MAAM,QAAQ,SACvB;EACJ;AACJ,GA1JO,8BAuGHsN,OAAAA,WAA2B;AACvB,MAAI,KAAK,MAAM,WAAW,UAAU;AAChC,SAAK,SAAS,EACV,aAAa,CACTM,GAAe,0BAA0B,QACzCA,GAAe,wBAAwB,MAC3C,EACJ,CAAC;AACD;EACJ;AAEA,MAAM,CAACC,GAAUC,CAAQ,IAAI,KAAK,MAAM,OAAO,MAAM,GAAG;AAExD,OAAK,SAAS,EACV,aAAa,CACTF,GAAe,0BAA0BC,CAAQ,GACjDD,GAAe,wBAAwBE,CAAQ,CACnD,EACJ,CAAC;AACL,GAnHA,cAPG,IAOI,2BAA0D,EAC7D,KAAK,GACL,QAAQ,KACR,QAAQ,KACZ,IAKA,cAhBG,IAgBI,6BAA8D,EACjE,MAAM,GACN,QAAQ,KACR,OAAO,KACX,IApBG;AGvCP,IAAMC,KAAqB;;AAA3B,IAcaC,KAANC,MAAA,MAA+C;EAwBlD,YAAY,EAAE,WAAAC,GAAW,UAAAnK,EAAS,GAAsD;AAxBrF;AAIM;AAKAoK,uBAAAA,KAAiC,oBAAI;AAKrCC,uBAAAA;AAKAC;AAML,SAAK,YAAYH,GACjB,mBAAKE,KAAYrK,IACjB,mBAAKsK,IAAWlB,GAA4B,IAAI;EACpD;EAKA,IAAI,eAAmE;AACnE,WAAO,mBAAKkB;EAChB;EAKA,iBAAiBC,GAAqC;AAClD,uBAAKH,KAAU,IAAIG,CAAa,GAChC,mBAAKF,KAAU,kBAAkB,gBAAgB;EACrD;EAKA,mBAAmBE,GAAqC;AAC/C,uBAAKH,KAAU,OAAOG,CAAa,KACpC,QAAQ,KAAK,sCAAsC;EAE3D;EAEA,iBAAuB;AACnB,uBAAKF,KAAU,kBAAkB,gBAAgB;EACrD;EAKA,OAAO,EAAE,OAAA1L,GAAO,QAAAC,EAAO,GAA4C;AAC/D,SAAK,UAAU,MAAM,QAAQD,IAAQ,MACrC,KAAK,UAAU,MAAM,SAASC,IAAS;EAC3C;EAKA,OAA+B;AAC3B,WAAK,mBAAKyL,KAAU,QAAQ,KAI5B,KAAK,eAAe,GACb;EACX;EAKA,iBAAuB;AACnB,QAAMG,IAGD,CAAC;AAEN,aAAWD,KAAiB,mBAAKH,KAAU,OAAO,GAAG;AACjD,UAAMK,IAAa,sBAAKC,oBAAL,WAA6B,EAAE,eAAAH,EAAc;AAChEC,QAAS,KAAK,EAAE,YAAAC,GAAY,eAAAF,EAAc,CAAC;IAC/C;AAEAC,MAAS,KAAK,CAACzE,GAAGE,MAAMA,EAAE,WAAW,gBAAgB,CAAC,IAAIF,EAAE,WAAW,gBAAgB,CAAC,CAAC,GACzFyE,EAAS,QAAQ,CAAC,EAAE,YAAAC,GAAY,eAAAF,EAAc,GAAGI,MAAY;AACzDJ,QAAc,cAAc,EAAE,GAAGE,GAAY,SAAAE,EAAQ,CAAC;IAC1D,CAAC;EACL;EA8CA,UAAgB;AAGZ,eAAW,MAAM;AACb,yBAAKP,KAAU,MAAM;IACzB,GAAG,CAAC;EACR;AACJ,GA5IaA,MAAAA,eAKAC,MAAAA,eAKAC,oBAnBN,8BAqGHI,OAAAA,SAAwB,EAAE,eAAAH,EAAc,GAAkD;AACtF,MAAMK,IAAkB,mBAAKP,KAAU,qBAAqB,EACxD,gBAAgBE,EAAc,gBAC9B,qBAAqBA,EAAc,gBACvC,CAAC,GAEKvF,IAAQuF,EAAc,eACtB,sBAAKM,oBAAL,WAA0B,EAAE,iBAAAD,GAAiB,cAAcL,EAAc,aAAa,KACtF,GAEAO,IAAaF,EAAgB,CAAC,IAAI,KAAOA,EAAgB,CAAC,IAAI;AAEpE,SAAO,EACH,iBAAAA,GACA,OAAA5F,GACA,YAAA8F,EACJ;AACJ,GAKAD,OAAAA,SAAqB,EAAE,iBAAAD,GAAiB,cAAAG,EAAa,GAA4D;;AAC7G,MAAM3K,KAAS8J,MAAA,mBAAKG,KAAU,sBAAf,gBAAAH,IAAkC;AACjD,MAAI,CAAC9J,EACD,OAAM,IAAI,MAAM,wBAAwB;AAG5C,MAAM4K,KACD5K,EAAO,mBAAmBA,EAAO,iBAAiB,aAAYA,OAAO,sBAAPA,mBAA0B,SAAS;AAMtG,YAJKA,EAAO,mBACFA,EAAO,iBAAiB,YAAY4J,MACpC5J,OAAO,sBAAPA,mBAA0B,UAAU,KAEhC4K,MAAS,IAAIJ,EAAgB,CAAC,KAAKG;AACrD,GAzIGb;AJLA,IAAMe,QAAiB1R,cAAAA,eAAmC,IAAI;AAO9D,SAAS2R,GAAa,EAAE,UAAAhR,GAAU,GAAGuD,EAAM,GAA8D;AAC5G,MAAM0N,QAAepQ,cAAAA,QAAuB,IAAI,GAC1C,CAACsO,GAAS+B,CAAU,QAAI/Q,cAAAA,UAA8B,IAAI,GAC1D,EAAE,UAAA2F,EAAS,QAAIzD,cAAAA,YAAW8C,CAAe;AAE/C,aAAAnE,cAAAA,WAAU,MAAM;AACZ,QAAI,CAAC8E,KAAY,CAACmL,EAAa,QAC3B;AAGJ,QAAM9B,IAAU,IAAIY,EAAa,EAAE,WAAWkB,EAAa,SAAS,UAAAnL,EAAS,CAAC;AAC9E,WAAAA,EAAS,WAAW,EAAE,SAAAqJ,EAAQ,CAAC,GAE/B+B,EAAW/B,CAAO,GAEX,MAAY;AACfrJ,QAAS,cAAc,EAAE,SAAAqJ,EAAQ,CAAC;IACtC;EACJ,GAAG,CAACrJ,GAAUmL,CAAY,CAAC,GAGvBlP,cAAAA,QAAA,cAACgP,EAAe,UAAf,EAAwB,OAAO5B,EAAAA,GAC5BpN,cAAAA,QAAA,cAAC,OAAA,EACG,KAAKkP,GACL,aAAU,kBACV,OAAO,EACH,UAAU,YACV,OAAO,QACP,QAAQ,QACR,KAAK,KACL,eAAe,QACf,SAAS,WACT,UAAU,SACd,GACC,GAAG1N,EAAAA,GAEHvD,CACL,CACJ;AAER;AKvDO,SAASmR,GAAa,EACzB,eAAAC,GACA,QAAAC,IAAS,UACT,aAAAC,GACA,UAAAtR,EACJ,GAI8B;AAC1B,MAAMmP,QAAU9M,eAAAA,YAAW0O,CAAc;AACzC,SAAK5B,IAKDpN,eAAAA,QAAA,cAACoN,EAAQ,cAAR,EAAqB,eAAeiC,GAAe,QAAQC,GAAQ,aAAaC,EAAAA,GAC5EtR,CACL,IANO;AAQf;AClBO,SAASuR,GAAU,EACtB,QAAAjP,GACA,aAAAgP,GACA,QAAAD,GACA,UAAArR,EACJ,GAIwB;AACpB,MAAM,CAACoR,GAAeI,CAAgB,QAAIrR,eAAAA,UAAemC,IAASA,EAAO,iBAAiB,WAAW,CAAC,GAAG,GAAG,CAAC,CAAC,GACxG,CAACmP,GAAWC,CAAY,QAAIvR,eAAAA,UAASmC,IAASA,EAAO,aAAa,KAAK;AAsB7E,aApBAtB,eAAAA,WAAU,MAAM;AACZ,QAAI,CAACsB,EACD;AAGJ,QAAMqP,IAAiB,MAAYH,EAAiBlP,EAAO,iBAAiB,QAAQ,GAC9EsP,IAAmB,MAAYF,EAAapP,EAAO,UAAU;AAGnE,WAAAqP,EAAe,GACfC,EAAiB,GAEjBtP,EAAO,iBAAiB,qBAAqBqP,CAAc,GAC3DrP,EAAO,iBAAiB,gCAAgCsP,CAAgB,GACjE,MAAY;AACftP,QAAO,oBAAoB,qBAAqBqP,CAAc,GAC9DrP,EAAO,oBAAoB,gCAAgCsP,CAAgB;IAC/E;EACJ,GAAG,CAACtP,CAAM,CAAC,GAEP,CAACA,KAAU,CAACmP,IACL,OAIP1P,eAAAA,QAAA,cAACoP,IAAA,EAAa,eAAeC,GAAe,QAAQC,GAAQ,aAAaC,EAAAA,GACpEtR,CACL;AAER;APhBI,OAAO,SAAW,QACb,OAAO,iBACR,OAAO,eAAe,CAAC,IAGvB,OAAO,UAAU,eAAe,KAAK,OAAO,cAAc,yBAAY,IACtE,QAAQ,KAAK,uEAAuE,IAEpF,OAAO,aAAa,yBAAY,IAAI;",
  "names": ["import_react", "import_react", "import_react", "import_react", "import_react", "import_react", "LivelinkContext", "createContext", "LivelinkProvider", "sceneId", "sessionId", "isTransient", "token", "LoadingPanel", "InactivityWarningPanel", "ConnectionErrorPanel", "autoJoinExisting", "clientType", "children", "instance", "setInstance", "useState", "isConnecting", "setIsConnecting", "isConnectionLost", "setIsConnectionLost", "inactivityWarning", "setInactivityWarning", "connectionError", "setConnectionError", "connectionPromises", "useRef", "disconnect", "useCallback", "useEffect", "connect", "session", "LivelinkInstance", "getOrCreateConnectionPromise", "params", "key", "getConnectionPromiseKey", "promise", "abort_controller", "onActivityDetected", "configureClient", "error", "onDisconnectedHandler", "event", "React", "configure", "webcodec", "useEntity", "entityProvider", "watchedComponents", "useContext", "entity", "setEntity", "isPending", "setIsPending", "forceUpdate", "useReducer", "x", "findEntityQuery", "foundEntity", "alwaysUpdate", "neverUpdate", "triggerUpdate", "useClients", "clients", "setClients", "onClientsChanged", "useCameraEntity", "props", "name", "position", "_orientation", "_eulerOrientation", "renderGraphRef", "settings", "renderTargetIndex", "_perspective_lens", "orientation", "eulerOrientation", "orthographic_lens", "perspective_lens", "cameraEntity", "CanvasContext", "Canvas", "contextType", "contextAttributes", "width", "height", "parentCanvas", "renderingSurface", "setRenderingSurface", "canvasRef", "rect", "surface", "RenderingSurface", "computeCanvasContainerStyle", "ViewportContext", "Viewport", "forwardRef", "setHoveredEntity", "setPickedEntity", "ref", "client", "cameraIndex", "otherProps", "canvas", "parentZIndex", "viewport", "setViewport", "clientCameraEntity", "setClientCameraEntity", "camera", "setCamera", "viewportDomElement", "useImperativeHandle", "onResize", "resizeObserver", "zIndex", "cameraEntities", "onEntityPicked", "e", "onEntityHovered", "CameraControllerContext", "CameraController", "preset", "CameraControllerPresets", "cameraController", "setCameraController", "controller", "DefaultCameraController", "Recorder", "fileOptions", "recorderOptions", "streamOptions", "recordTime", "setRecordTime", "isRecording", "setIsRecording", "mediaRecorder", "useMemo", "stream", "fileHandle", "fileStream", "interval", "prev", "EPSILON", "ARRAY_TYPE", "RANDOM", "degree", "y", "i", "vec3_exports", "__export", "add", "angle", "bezier", "ceil", "clone", "copy", "create", "cross", "dist", "distance", "div", "divide", "dot", "equals", "exactEquals", "floor", "forEach", "fromValues", "hermite", "inverse", "len", "length", "lerp", "max", "min", "mul", "multiply", "negate", "normalize", "random", "rotateX", "rotateY", "rotateZ", "round", "scale", "scaleAndAdd", "set", "sqrDist", "sqrLen", "squaredDistance", "squaredLength", "str", "sub", "subtract", "transformMat3", "transformMat4", "transformQuat", "zero", "out", "a", "z", "b", "ax", "ay", "az", "bx", "by", "bz", "t", "c", "d", "factorTimes2", "factor1", "factor2", "factor3", "factor4", "inverseFactor", "inverseFactorTimesTwo", "r", "zScale", "m", "w", "q", "qx", "qy", "qz", "qw", "uvx", "uvy", "uvz", "uuvx", "uuvy", "uuvz", "w2", "rad", "p", "mag1", "mag2", "mag", "cosine", "a0", "a1", "a2", "b0", "b1", "b2", "vec", "stride", "offset", "count", "fn", "arg", "createReact3DElementFactory", "overlay", "React3DElement", "#updateTranslation", "prevProps", "v", "state", "transformStyle", "createPortal", "_React3DElement", "anchor_x", "anchor_y", "INFINITE_FAR_VALUE", "ReactOverlay", "_a", "container", "#elements", "#viewport", "#factory", "react_element", "elements", "projection", "#projectElementOnScreen", "z_index", "screen_position", "#computeElementScale", "is_visible", "scale_factor", "near", "OverlayContext", "DOM3DOverlay", "containerRef", "setOverlay", "DOM3DElement", "worldPosition", "anchor", "scaleFactor", "DOMEntity", "setWorldPosition", "isVisible", "setIsVisible", "updatePosition", "updateVisibility"]
}
