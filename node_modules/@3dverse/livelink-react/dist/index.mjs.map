{
  "version": 3,
  "sources": ["../sources/hooks/useEntity.ts", "../sources/components/core/Livelink.tsx", "../sources/hooks/useClients.ts", "../sources/hooks/useCameraEntity.ts", "../sources/components/core/Canvas.tsx", "../sources/components/core/Viewport.tsx", "../sources/components/core/CameraController.tsx", "../sources/components/utils/Recorder.tsx", "../sources/index.ts", "../sources/components/overlays/DOM3DOverlay.tsx", "../sources/overlays/React3DElement.tsx", "../../node_modules/gl-matrix/esm/common.js", "../../node_modules/gl-matrix/esm/vec3.js", "../sources/overlays/ReactOverlay.ts", "../sources/components/overlays/DOM3DElement.tsx", "../sources/components/overlays/DOMEntity.tsx"],
  "sourcesContent": ["//------------------------------------------------------------------------------\nimport { useContext, useEffect, useReducer, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport type {\n    Entity,\n    EntityCreationOptions,\n    ComponentsManifest,\n    FindEntityQuery,\n    UUID,\n    ComponentName,\n    EntityUpdatedEvent,\n} from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"../components/core/Livelink\";\n\n/**\n * An new entity instance.\n *\n * @inline\n */\ntype NewEntity = {\n    /**\n     * The name of the entity.\n     */\n    name: string;\n\n    /**\n     * The components to attach to the entity with their initial values.\n     */\n    components: ComponentsManifest;\n\n    /**\n     * The creation options of the entity.\n     */\n    options: EntityCreationOptions;\n};\n\n/**\n * @inline\n */\ntype FindEntityQueryByNames = {\n    /**\n     * The names of the entities to find.\n     */\n    names: Array<string>;\n};\n\n/**\n * @inline\n */\ntype FindEntityQueryByName = {\n    /**\n     * The name of the entity to find.\n     */\n    name: string;\n};\n\n/**\n * A provider of an entity.\n */\ntype EntityProvider = NewEntity | FindEntityQueryByName | Exclude<FindEntityQuery, FindEntityQueryByNames>;\n\n/**\n * A hook that provides an entity and a flag indicating if the entity is pending loading.\n *\n * @example\n * ```tsx\n * const { isPending, entity } = useEntity({ id: \"00000000-0000-0000-0000-000000000000\" });\n * if (isPending) {\n *     return <div>Loading...</div>;\n * }\n * if (!entity) {\n *     return <div>Entity not found</div>;\n * }\n * return <div>Entity found: {entity.name}</div>;\n * ```\n * @param entityProvider - The entity provider.\n * @returns The entity and a flag indicating if the entity is pending loading.\n *\n * @category Hooks\n */\nexport function useEntity(\n    entityProvider: EntityProvider,\n    watchedComponents: Array<ComponentName> | \"any\" = [],\n): {\n    isPending: boolean;\n    entity: Entity | null;\n} {\n    const { instance } = useContext(LivelinkContext);\n\n    const [entity, setEntity] = useState<Entity | null>(null);\n    const [isPending, setIsPending] = useState(true);\n    const [, forceUpdate] = useReducer(x => x + 1, 0);\n\n    const findEntityQuery = entityProvider as {\n        euid?: UUID;\n        linkage?: Array<UUID>;\n        name?: string;\n        mandatory_components?: Array<ComponentName>;\n        forbidden_components?: Array<ComponentName>;\n    };\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        const resolveEntity = async (): Promise<Entity | null> => {\n            if (\"components\" in entityProvider) {\n                console.debug(\"---- Creating entity\");\n                return await instance.scene.newEntity(entityProvider);\n            } else if (\"linkage\" in findEntityQuery) {\n                return await instance.scene.findEntity({\n                    entity_uuid: findEntityQuery.euid!,\n                    linkage: findEntityQuery.linkage,\n                });\n            } else if (\"euid\" in findEntityQuery) {\n                return (await instance.scene.findEntities({ entity_uuid: findEntityQuery.euid! }))[0];\n            } else if (\"name\" in findEntityQuery && findEntityQuery.name) {\n                return (await instance.scene.findEntitiesByNames({ entity_names: [findEntityQuery.name] }))[0];\n            } else if (\"mandatory_components\" in findEntityQuery) {\n                return (\n                    await instance.scene.findEntitiesWithComponents({\n                        mandatory_components: findEntityQuery.mandatory_components!,\n                        forbidden_components: findEntityQuery.forbidden_components,\n                    })\n                )[0];\n            }\n            return null;\n        };\n\n        resolveEntity()\n            .then(foundEntity => setEntity(foundEntity))\n            .finally(() => setIsPending(false));\n\n        return (): void => {\n            setEntity(null);\n            setIsPending(true);\n        };\n    }, [instance, JSON.stringify(findEntityQuery)]);\n\n    useEffect(() => {\n        const alwaysUpdate = watchedComponents === \"any\";\n        const neverUpdate = watchedComponents.length === 0;\n\n        if (!entity || neverUpdate) {\n            return;\n        }\n\n        const triggerUpdate = alwaysUpdate\n            ? forceUpdate\n            : (event: EntityUpdatedEvent): void => {\n                  if (event.isAnyComponentDirty({ components: watchedComponents })) {\n                      forceUpdate();\n                  }\n              };\n\n        entity.addEventListener(\"on-entity-updated\", triggerUpdate);\n\n        return (): void => {\n            entity.removeEventListener(\"on-entity-updated\", triggerUpdate);\n        };\n    }, [entity, watchedComponents]);\n\n    return { isPending, entity };\n}\n", "//------------------------------------------------------------------------------\nimport React, { createContext, JSX, PropsWithChildren, useCallback, useEffect, useRef, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport * as Livelink from \"@3dverse/livelink\";\nimport { Livelink as LivelinkInstance, type UUID } from \"@3dverse/livelink\";\nimport { StrictUnion } from \"../../utils\";\n\n/**\n * Context for managing the Livelink connection state.\n *\n * Provides information about the current Livelink instance, connection status,\n * and a method to disconnect from the Livelink service.\n *\n * @category Contexts\n */\nexport const LivelinkContext = createContext<{\n    /** The current Livelink instance or `null` if not connected. */\n    instance: LivelinkInstance | null;\n\n    /** Indicates whether the connection is currently in progress. */\n    isConnecting: boolean;\n\n    /** Indicates whether the connection has been disconnected. */\n    isDisconnected: boolean;\n\n    /** Function to disconnect from the current Livelink session. */\n    disconnect: () => void;\n}>({\n    instance: null,\n    isConnecting: false,\n    isDisconnected: false,\n    disconnect: () => {},\n});\n\n/**\n * Represents the mode for joining an existing session.\n *\n * @inline\n */\nexport type SessionJoinMode = {\n    /**\n     * The UUID of the session to join.\n     */\n    sessionId: UUID;\n};\n\n/**\n * Represents the mode for either joining or starting a session.\n *\n * @inline\n */\nexport type SessionJoinOrStart = {\n    /**\n     * The UUID of the scene to connect to or start a session on.\n     */\n    sceneId: UUID;\n\n    /**\n     * Whether to automatically join any existing session.\n     */\n    autoJoinExisting?: boolean;\n\n    /**\n     * If a new session is started, specifies whether it is transient (non-persistent).\n     * If a session is joined, this property is ignored.\n     */\n    isTransient?: boolean;\n};\n\n/**\n * Represents the mode for joining an existing session as a guest user.\n *\n * @inline\n */\nexport type SessionJoinGuest = {\n    /**\n     * The authentication type for the guest client.\n     */\n    clientType: \"guest\";\n};\n\n/**\n * Represents the union of all possible session open modes.\n *\n * This type includes:\n * - `SessionJoinMode`: For joining an existing session.\n * - `SessionJoinOrStart`: For joining or starting a session based on the provided context.\n *\n * @inline\n */\nexport type SessionOpenMode = StrictUnion<SessionJoinMode | SessionJoinOrStart | SessionJoinGuest>;\n\n/**\n * Parameters for establishing a Livelink connection.\n *\n * Extends `SessionOpenMode` to define the session behavior and includes additional\n * options for handling connection lifecycle events, UI components, and settings.\n *\n * @inline\n * @category Components\n */\nexport type LivelinkConnectParameters = {\n    /**\n     * Authentication token required to establish the connection.\n     */\n    token: string;\n\n    /**\n     * Optional React component or node displayed while the connection is loading.\n     */\n    LoadingPanel?: React.ComponentType<{ stage: string }>;\n\n    /**\n     * Optional React component or node displayed when an inactivity timeout occurs.\n     */\n    InactivityWarningPanel?: React.ComponentType<{ warningDuration: number; onActivityDetected: () => void }>;\n\n    /**\n     * Optional React component or node displayed when the connection is disconnected.\n     */\n    ConnectionErrorPanel?: React.ComponentType<{ error: string }>;\n} & SessionOpenMode;\n\n/**\n * Connection promises map.\n *\n * To deal with React strict mode, and avoiding to create a session multiple times,\n * we need to keep track of the connection promises. The promises are stored\n * using the connection parameters as key.\n *\n * @internal\n */\ntype ConnectionPromisesMap = Map<string, Promise<Livelink.Livelink>>;\n\n/**\n * Provides the Livelink context and manages the lifecycle of a Livelink connection.\n *\n * This component initializes and maintains a connection to the Livelink service\n * and supplies relevant connection state and methods to its children via context.\n *\n * @param params\n *\n * @param params.children - React children components that will have access to the Livelink context.\n * @param params.sceneId - The unique identifier of the scene to connect to (required for \"start\" or \"join-or-start\").\n * @param params.sessionId - The unique identifier of the session to join (required for \"join\").\n * @param params.isTransient - Specifies if the connection is transient (non-persistent).\n * @param params.token - The authentication token required for the Livelink connection.\n * @param params.LoadingPanel - Optional React node displayed while the connection is being established.\n * @param params.InactivityWarningPanel - Optional React node displayed when an inactivity timeout occurs.\n * @param params.ConnectionErrorPanel - Optional React node displayed when the connection is lost.\n * @param params.autoJoinExisting - Specifies the mode for opening the session; defaults to `\"join-or-start\"`.\n *\n * @category Components\n */\nexport function LivelinkProvider({\n    sceneId,\n    sessionId,\n    isTransient,\n    token,\n    LoadingPanel,\n    InactivityWarningPanel,\n    ConnectionErrorPanel,\n    autoJoinExisting = true,\n    clientType,\n    children,\n}: PropsWithChildren<LivelinkConnectParameters>): JSX.Element {\n    const [instance, setInstance] = useState<LivelinkInstance | null>(null);\n    const [isConnecting, setIsConnecting] = useState(true);\n    const [isConnectionLost, setIsConnectionLost] = useState(false);\n    const [inactivityWarning, setInactivityWarning] = useState<Livelink.InactivityWarningEvent | null>(null);\n    const [connectionError, setConnectionError] = useState<string>(\"Unknown error\");\n    const connectionPromises = useRef<ConnectionPromisesMap>(new Map());\n\n    const disconnect = useCallback(() => instance?.disconnect(), [instance]);\n\n    useEffect(() => {\n        const connect = async ({\n            autoJoinExisting,\n            sceneId,\n            sessionId,\n            clientType,\n        }: SessionOpenMode): Promise<Livelink.Livelink> => {\n            if (sessionId) {\n                const session = await Livelink.Session.findById({ session_id: sessionId, token });\n                if (!session) {\n                    throw new Error(`Session '${sessionId}' not found on scene '${sceneId}'`);\n                }\n                return LivelinkInstance.join({ session });\n            }\n\n            if (sceneId) {\n                if (autoJoinExisting) {\n                    return LivelinkInstance.join_or_start({ scene_id: sceneId, token, is_transient: isTransient });\n                } else {\n                    return LivelinkInstance.start({ scene_id: sceneId, token, is_transient: isTransient });\n                }\n            }\n\n            if (clientType === \"guest\") {\n                const session = await Livelink.Session.findByGuestToken({ guest_token: token });\n                if (!session) {\n                    throw new Error(`No session available for guest token '${token}'`);\n                }\n\n                return LivelinkInstance.join({ session });\n            }\n\n            throw new Error(\"What are we doing here?!\");\n        };\n\n        /**\n         * To deal with React strict mode, and avoiding to create a session multiple times,\n         * we need to keep track of the connection promises. The promises are stored\n         * using the connection parameters as key.\n         *\n         * @returns The connection promise for the given parameters.\n         */\n        const getOrCreateConnectionPromise = (params: LivelinkConnectParameters): Promise<Livelink.Livelink> => {\n            const key = getConnectionPromiseKey(params);\n            let promise = connectionPromises.current.get(key);\n            if (!promise) {\n                promise = connect(params).then(instance => {\n                    connectionPromises.current.delete(key);\n                    return instance;\n                });\n                connectionPromises.current.set(key, promise);\n            }\n            return promise;\n        };\n\n        /**\n         * Abort controller to avoid side effects when the component is unmounted.\n         */\n        const abort_controller = new AbortController();\n\n        const onActivityDetected = (): void => {\n            setInactivityWarning(null);\n        };\n\n        getOrCreateConnectionPromise({\n            autoJoinExisting,\n            sceneId,\n            sessionId,\n            token,\n            clientType,\n        } as LivelinkConnectParameters)\n            .then(instance => {\n                // if the component is unmounted, stop right here, and do not proceed with the connection\n                if (abort_controller.signal.aborted) {\n                    return;\n                }\n\n                console.debug(\"Connected to Livelink\", instance);\n                configureClient(instance);\n                setInstance(instance);\n                instance.TO_REMOVE__setReadyCallback(async () => {\n                    instance.startStreaming();\n                    setIsConnecting(false);\n                });\n\n                instance.session.addEventListener(\"on-inactivity-warning\", setInactivityWarning);\n                instance.session.addEventListener(\"on-activity-detected\", onActivityDetected);\n            })\n            .catch(error => {\n                console.debug(\"Failed to connect to Livelink\", error);\n                setIsConnecting(false);\n                setIsConnectionLost(true);\n                setConnectionError(error);\n            });\n\n        return (): void => {\n            abort_controller.abort();\n\n            instance?.session.removeEventListener(\"on-inactivity-warning\", setInactivityWarning);\n            instance?.session.removeEventListener(\"on-activity-detected\", onActivityDetected);\n\n            setInstance(null);\n            setIsConnecting(true);\n            setIsConnectionLost(false);\n            setInactivityWarning(null);\n        };\n    }, [token, autoJoinExisting, sceneId, sessionId, isTransient, clientType]);\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        // Allow the hook user to be notified of a disconnection occuring while the above operations run.\n        // Still not perfect, because the gateway might disconnect before the instance is returned during\n        // the GatewayController.authenticateClient or EditorController.connectToSession of livelink-core.\n        // Also nothing's notify the livelink user of a loss of the EditorConnection.\n\n        const onDisconnectedHandler = (event: Livelink.DisconnectedEvent): void => {\n            setIsConnectionLost(true);\n            setInactivityWarning(null);\n            setConnectionError(event.reason);\n        };\n\n        instance.session.addEventListener(\"on-disconnected\", onDisconnectedHandler);\n\n        return (): void => {\n            instance.session.removeEventListener(\"on-disconnected\", onDisconnectedHandler);\n        };\n    }, [instance]);\n\n    // Disconnect when unmounted\n    useEffect(() => {\n        return (): void => {\n            instance?.disconnect();\n        };\n    }, [instance]);\n\n    return (\n        <LivelinkContext.Provider\n            value={{\n                instance,\n                isConnecting,\n                isDisconnected: isConnectionLost,\n                disconnect,\n            }}\n        >\n            {isConnecting && LoadingPanel && <LoadingPanel stage={\"\"} />}\n            {isConnectionLost && ConnectionErrorPanel && <ConnectionErrorPanel error={connectionError} />}\n            {inactivityWarning && InactivityWarningPanel && (\n                <InactivityWarningPanel\n                    warningDuration={inactivityWarning.seconds_remaining}\n                    onActivityDetected={() => {\n                        inactivityWarning.resetTimer();\n                        setInactivityWarning(null);\n                    }}\n                />\n            )}\n            {children}\n        </LivelinkContext.Provider>\n    );\n}\n\n//------------------------------------------------------------------------------\nfunction configureClient(instance: LivelinkInstance): void {\n    const configure = async (): Promise<void> => {\n        instance.session.removeEventListener(\"TO_REMOVE__viewports-added\", configure);\n\n        console.debug(\"-- Configuring client\");\n        const webcodec = await Livelink.WebCodecsDecoder.findSupportedCodec();\n        await instance.configureRemoteServer({ codec: webcodec || undefined });\n\n        await instance.setEncodedFrameConsumer({\n            encoded_frame_consumer:\n                webcodec !== null\n                    ? new Livelink.WebCodecsDecoder({ decoded_frame_consumer: instance.default_decoded_frame_consumer })\n                    : new Livelink.SoftwareDecoder({ decoded_frame_consumer: instance.default_decoded_frame_consumer }),\n        });\n\n        instance.TO_REMOVE__startIfReady();\n    };\n\n    instance.session.addEventListener(\"TO_REMOVE__viewports-added\", configure);\n}\n\n//------------------------------------------------------------------------------\nfunction getConnectionPromiseKey(params: LivelinkConnectParameters): string {\n    return JSON.stringify(params);\n}\n\n//------------------------------------------------------------------------------\nexport { LivelinkProvider as Livelink };\n", "//------------------------------------------------------------------------------\nimport { useContext, useEffect, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport { Client } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"../components/core/Livelink\";\n\n/**\n * Provides a list of all clients connected to the current session.\n *\n * @category Hooks\n */\nexport function useClients(): { clients: Array<Client> } {\n    const { instance } = useContext(LivelinkContext);\n\n    const [clients, setClients] = useState<Array<Client>>([]);\n\n    useEffect(() => {\n        if (!instance) {\n            return;\n        }\n\n        const onClientsChanged = (): void => setClients(instance.session.other_clients);\n\n        instance.session.addEventListener(\"on-client-joined\", onClientsChanged);\n        instance.session.addEventListener(\"on-client-left\", onClientsChanged);\n\n        onClientsChanged();\n\n        return (): void => {\n            instance.session.removeEventListener(\"on-client-joined\", onClientsChanged);\n            instance.session.removeEventListener(\"on-client-left\", onClientsChanged);\n            setClients([]);\n        };\n    }, [instance]);\n\n    return { clients };\n}\n", "//------------------------------------------------------------------------------\nimport type { Vec3, Quat, RenderGraphDataObject, Entity, UUID, ComponentName, Components } from \"@3dverse/livelink\";\nimport { useEntity } from \"./useEntity\";\nimport { StrictUnion } from \"../utils\";\n\n/**\n * An exclusive union of the perspective and orthographic lenses.\n * @inline\n * @internal\n */\nexport type CameraLensProps =\n    | {\n          /**\n           * The perspective lens of the camera entity, can't be used with orthographic_lens.\n           */\n          perspective_lens?: Partial<Components.PerspectiveLens>;\n      }\n    | {\n          /**\n           * The orthographic lens of the camera entity, can't be used with perspective_lens.\n           */\n          orthographic_lens?: Partial<Components.OrthographicLens>;\n      };\n\n/**\n * The properties of the render graph the camera will entity use.\n * @inline\n * @internal\n */\nexport type RenderGraphProps = {\n    /**\n     * The render graph to use within the camera entity.\n     */\n    renderGraphRef?: UUID;\n\n    /**\n     * The settings of the camera entity.\n     */\n    settings?: RenderGraphDataObject;\n\n    /**\n     * The render target index to use to render the frame.\n     */\n    renderTargetIndex?: number;\n};\n\n/**\n * The properties of the initial transform of the camera entity.\n * Defines an exclusive union between orientation and eulerOrientation.\n * @inline\n * @internal\n */\nexport type OrientationProps =\n    | {\n          /**\n           * The initial orientation of the camera entity in quaternion form, can't be used with eulerOrientation.\n           */\n          orientation?: Quat;\n      }\n    | {\n          /**\n           * The initial orientation of the camera entity in Euler angles form, can't be used with orientation.\n           */\n          eulerOrientation?: Vec3;\n      };\n\n/**\n * The properties used to create a camera entity.\n * @inline\n * @internal\n */\nexport type UseCameraEntityProps = {\n    /**\n     * The name of the camera entity.\n     */\n    name?: string;\n\n    /**\n     * The initial position of the camera entity.\n     */\n    position?: Vec3;\n} & StrictUnion<OrientationProps> &\n    StrictUnion<CameraLensProps> &\n    RenderGraphProps;\n\n/**\n * A hook that creates a camera entity.\n *\n * @param props - The properties used to create the camera entity.\n * @param watchedComponents - The components to watch for changes. If any component in this list changes,\n * the entity trigger a redraw. If set to \"any\", the entity will trigger a redraw on any component change.\n *\n * @returns The camera entity and a boolean indicating if the entity is pending creation.\n *\n * @category Hooks\n */\nexport function useCameraEntity(\n    props: UseCameraEntityProps = {},\n    watchedComponents: Array<ComponentName> | \"any\" = [],\n): {\n    isPending: boolean;\n    cameraEntity: Entity | null;\n} {\n    const {\n        name = \"Camera\",\n        position = [0, 1, 5],\n        orientation: _orientation = [0, 0, 0, 1],\n        eulerOrientation: _eulerOrientation = [0, 0, 0],\n        renderGraphRef = \"398ee642-030a-45e7-95df-7147f6c43392\",\n        settings = { grid: true, skybox: false, gradient: true },\n        renderTargetIndex = -1,\n        perspective_lens: _perspective_lens = { fovy: 60, nearPlane: 0.1, farPlane: 10000 },\n    } = props;\n\n    const orientation = \"orientation\" in props ? _orientation : undefined;\n    const eulerOrientation = !orientation && \"eulerOrientation\" in props ? _eulerOrientation : undefined;\n\n    const orthographic_lens = \"orthographic_lens\" in props ? props.orthographic_lens : undefined;\n    const perspective_lens = !orthographic_lens ? _perspective_lens : undefined;\n\n    const { isPending, entity: cameraEntity } = useEntity(\n        {\n            name,\n            components: {\n                local_transform: { position, orientation, eulerOrientation },\n                camera: { renderGraphRef, dataJSON: settings, renderTargetIndex },\n                perspective_lens,\n                orthographic_lens,\n            },\n            options: { auto_broadcast: false, delete_on_client_disconnection: true },\n        },\n        watchedComponents,\n    );\n\n    return { isPending, cameraEntity };\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    CSSProperties,\n    HTMLProps,\n    JSX,\n    PropsWithChildren,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport { RenderingSurface } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"./Livelink\";\n\n/**\n * Context providing the canvas element and the rendering surface.\n *\n * @param canvas - The canvas element.\n * @param renderingSurface - The rendering surface.\n *\n * @category Contexts\n */\nexport const CanvasContext = createContext<{\n    canvas: HTMLCanvasElement | null;\n    renderingSurface: RenderingSurface | null;\n}>({\n    canvas: null,\n    renderingSurface: null,\n});\n\n//------------------------------------------------------------------------------\ntype CanvasContext =\n    | {\n          contextType: \"2d\";\n          contextAttributes?: CanvasRenderingContext2DSettings;\n      }\n    | {\n          contextType: \"webgl\";\n          contextAttributes?: WebGLContextAttributes & { xrCompatible?: boolean };\n      }\n    | {\n          contextType?: undefined;\n          contextAttributes?: undefined;\n      };\n\n/**\n * A component that provides a canvas element and a rendering surface.\n *\n * @param params - The canvas context.\n * @param params.children - The children to render.\n * @param params.contextType - The context type of the canvas.\n * @param params.contextAttributes - The context attributes of the canvas.\n * @param params.width - The width of the canvas.\n * @param params.height - The height of the canvas.\n *\n * @returns The canvas component.\n *\n * @category Components\n */\nexport function Canvas({\n    children,\n    contextType = \"2d\",\n    contextAttributes,\n    width,\n    height,\n    ...props\n}: PropsWithChildren<CanvasContext & HTMLProps<HTMLDivElement>>): JSX.Element {\n    const { instance } = useContext(LivelinkContext);\n    const { canvas: parentCanvas } = useContext(CanvasContext);\n\n    const [renderingSurface, setRenderingSurface] = useState<RenderingSurface | null>(null);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    useEffect(() => {\n        if (!instance || !canvasRef.current) {\n            return;\n        }\n\n        console.debug(\"--- Setting rendering surface\");\n\n        const rect = canvasRef.current.getBoundingClientRect();\n        if (!rect.width || !rect.height) {\n            console.error(\n                `Canvas element has an invalid size : [${rect.width} x ${rect.height}] it will not be mounted as a rendering surface.`,\n                canvasRef.current,\n            );\n            return;\n        }\n\n        const surface = new RenderingSurface({\n            canvas_element: canvasRef.current,\n            context_type: contextType,\n            context_attributes: contextAttributes,\n        });\n\n        setRenderingSurface(surface);\n\n        return (): void => {\n            console.debug(\"--- Removing rendering surface\");\n            surface.release();\n            setRenderingSurface(null);\n        };\n    }, [instance, contextType, contextAttributes]);\n\n    return (\n        <CanvasContext.Provider value={{ canvas: canvasRef.current, renderingSurface }}>\n            <div\n                data-role=\"canvas-container\"\n                style={computeCanvasContainerStyle({ parentCanvas, width, height })}\n                {...props}\n            >\n                <canvas\n                    ref={canvasRef}\n                    style={{\n                        position: \"absolute\",\n                        width: \"100%\",\n                        height: \"100%\",\n                        pointerEvents: \"none\",\n                    }}\n                />\n                {children}\n            </div>\n        </CanvasContext.Provider>\n    );\n}\n\n//------------------------------------------------------------------------------\nfunction computeCanvasContainerStyle({\n    parentCanvas,\n    width,\n    height,\n}: {\n    parentCanvas: HTMLCanvasElement | null;\n    width?: string | number;\n    height?: string | number;\n}): CSSProperties {\n    const isNestedCanvas = Boolean(parentCanvas);\n    const commonStyle = { overflow: \"clip\" } satisfies CSSProperties;\n    const nestedCanvasStyle = { position: \"absolute\", width, height } satisfies CSSProperties;\n    const rootCanvasStyle = {\n        position: \"relative\",\n        width: width ?? \"100%\",\n        height: height ?? \"100%\",\n    } satisfies CSSProperties;\n    return { ...commonStyle, ...(isNestedCanvas ? nestedCanvasStyle : rootCanvasStyle) };\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    forwardRef,\n    HTMLProps,\n    JSX,\n    Ref,\n    PropsWithChildren,\n    useCallback,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n    useImperativeHandle,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport * as Livelink from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { LivelinkContext } from \"./Livelink\";\nimport { CanvasContext } from \"./Canvas\";\nimport { StrictUnion } from \"../../utils\";\n\n/**\n * Context that provides a viewport.\n *\n * @category Contexts\n */\nexport const ViewportContext = createContext<{\n    viewport: Livelink.Viewport | null;\n    viewportDomElement: HTMLDivElement | null;\n    zIndex: number;\n    camera: Livelink.CameraProjection | null;\n}>({\n    viewport: null,\n    viewportDomElement: null,\n    zIndex: 0,\n    camera: null,\n});\n\n/**\n * A viewport component.\n *\n * @category Components\n */\nexport const Viewport = forwardRef(function (\n    {\n        setHoveredEntity,\n        setPickedEntity,\n        renderTargetIndex = -1,\n        children,\n        ...props\n    }: PropsWithChildren<\n        StrictUnion<\n            | {\n                  cameraEntity: Livelink.Entity | null;\n              }\n            | {\n                  client: Livelink.Client;\n                  cameraIndex?: number;\n              }\n        > & {\n            setHoveredEntity?: (\n                data: { entity: Livelink.Entity; ws_position: Livelink.Vec3; ws_normal: Livelink.Vec3 } | null,\n            ) => void;\n            setPickedEntity?: (\n                data: { entity: Livelink.Entity; ws_position: Livelink.Vec3; ws_normal: Livelink.Vec3 } | null,\n            ) => void;\n            renderTargetIndex?: number;\n        } & HTMLProps<HTMLDivElement>\n    >,\n    ref: Ref<Livelink.Viewport | undefined>,\n): JSX.Element {\n    const { cameraEntity, client, cameraIndex, ...otherProps } = props as {\n        cameraEntity?: Livelink.Entity | null;\n        cameraIndex?: number;\n        client?: Livelink.Client;\n    } & HTMLProps<HTMLDivElement>;\n\n    //--------------------------------------------------------------------------\n    const { instance } = useContext(LivelinkContext);\n    const { renderingSurface, canvas } = useContext(CanvasContext);\n    const { zIndex: parentZIndex = 0 } = useContext(ViewportContext);\n\n    //--------------------------------------------------------------------------\n    const [viewport, setViewport] = useState<Livelink.Viewport | null>(null);\n    const [clientCameraEntity, setClientCameraEntity] = useState<Livelink.Entity | null>(null);\n    const [camera, setCamera] = useState<Livelink.CameraProjection | null>(null);\n    const viewportDomElement = useRef<HTMLDivElement>(null);\n\n    //--------------------------------------------------------------------------\n    useImperativeHandle(ref, () => viewport ?? undefined, [viewport]);\n\n    //--------------------------------------------------------------------------\n    const onResize = useCallback(() => {\n        if (!viewportDomElement.current || !canvas || !viewport) {\n            return;\n        }\n\n        console.debug(\"---- Resizing viewport\", viewportDomElement.current);\n        viewport.relative_rect = Livelink.RelativeRect.from_dom_elements({\n            element: viewportDomElement.current,\n            parent: canvas,\n        });\n    }, [viewport, canvas, viewportDomElement.current]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewportDomElement.current) {\n            return;\n        }\n\n        const resizeObserver = new ResizeObserver(onResize);\n        resizeObserver.observe(viewportDomElement.current);\n        return (): void => {\n            resizeObserver.disconnect();\n        };\n    }, [viewportDomElement.current, onResize]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!renderingSurface) {\n            return;\n        }\n\n        renderingSurface.addEventListener(\"on-rendering-surface-resized\", onResize);\n        return (): void => {\n            renderingSurface.removeEventListener(\"on-rendering-surface-resized\", onResize);\n        };\n    }, [renderingSurface, onResize]);\n\n    //--------------------------------------------------------------------------\n    const zIndex = parentZIndex + 1;\n    useEffect(() => {\n        if (!instance || !renderingSurface || !canvas || !viewportDomElement.current) {\n            return;\n        }\n\n        try {\n            const rect = Livelink.RelativeRect.from_dom_elements({\n                element: viewportDomElement.current,\n                parent: canvas,\n            });\n\n            const viewport = new Livelink.Viewport({\n                core: instance,\n                rendering_surface: renderingSurface,\n                options: {\n                    rect,\n                    z_index: zIndex,\n                    render_target_index: renderTargetIndex,\n                    dom_element: viewportDomElement.current,\n                },\n            });\n\n            console.debug(\"---- Setting viewport\", viewport.width, viewport.height, zIndex);\n            instance.addViewports({ viewports: [viewport] });\n            setViewport(viewport);\n\n            return (): void => {\n                console.debug(\"---- Removing viewport\");\n                instance.removeViewport({ viewport });\n                viewport.release();\n                setViewport(null);\n            };\n        } catch (error) {\n            if (error instanceof Livelink.OutOfBoundsError) {\n                console.error(\n                    \"A viewport MUST be contained into its parent Canvas bounds\",\n                    viewportDomElement.current,\n                    canvas,\n                );\n            } else if (error instanceof Livelink.InvalidSizeError) {\n                console.error(\n                    `Viewport element has an invalid size : [${error.rect.width} x ${error.rect.height}].`,\n                    canvas,\n                );\n            } else {\n                console.error(\"Failed to mount viewport\", viewportDomElement.current, error);\n            }\n        }\n    }, [instance, renderingSurface, canvas, zIndex]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (client) {\n            client.getCameraEntities().then(cameraEntities => {\n                setClientCameraEntity(cameraEntities[cameraIndex ?? 0]);\n            });\n        } else {\n            setClientCameraEntity(cameraEntity ?? null);\n        }\n    }, [cameraEntity, client, cameraIndex]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewport || !clientCameraEntity) {\n            return;\n        }\n\n        console.debug(\"---- Setting camera\", clientCameraEntity);\n        viewport.camera_projection = new Livelink.CameraProjection({ camera_entity: clientCameraEntity, viewport });\n        setCamera(viewport.camera_projection);\n    }, [viewport, clientCameraEntity]);\n\n    //--------------------------------------------------------------------------\n    useEffect(() => {\n        if (!viewport) {\n            return;\n        }\n\n        const onEntityPicked = (e: Livelink.EntityPickedEvent): void =>\n            setPickedEntity?.(\n                e.picked_entity && e.ws_position && e.ws_normal\n                    ? { entity: e.picked_entity, ws_position: e.ws_position, ws_normal: e.ws_normal }\n                    : null,\n            );\n        if (setPickedEntity) {\n            viewport.activatePicking();\n            viewport.addEventListener(\"on-entity-picked\", onEntityPicked);\n        }\n\n        const onEntityHovered = (e: Livelink.EntityHoveredEvent): void =>\n            setHoveredEntity?.(\n                e.hovered_entity && e.ws_position && e.ws_normal\n                    ? { entity: e.hovered_entity, ws_position: e.ws_position, ws_normal: e.ws_normal }\n                    : null,\n            );\n        if (setHoveredEntity) {\n            viewport.activateHovering();\n            viewport.addEventListener(\"on-entity-hovered\", onEntityHovered);\n        }\n\n        return (): void => {\n            if (setPickedEntity) {\n                viewport.removeEventListener(\"on-entity-picked\", onEntityPicked);\n                viewport.deactivatePicking();\n            }\n\n            if (setHoveredEntity) {\n                viewport.removeEventListener(\"on-entity-hovered\", onEntityHovered);\n                viewport.deactivateHovering();\n            }\n        };\n    }, [viewport, setPickedEntity, setHoveredEntity]);\n\n    //--------------------------------------------------------------------------\n    return (\n        <ViewportContext.Provider\n            value={{\n                viewport,\n                viewportDomElement: viewportDomElement.current,\n                zIndex,\n                camera: camera,\n            }}\n        >\n            <div ref={viewportDomElement} data-role=\"viewport\" {...otherProps}>\n                {children}\n            </div>\n        </ViewportContext.Provider>\n    );\n});\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    forwardRef,\n    PropsWithChildren,\n    Ref,\n    useContext,\n    useEffect,\n    useImperativeHandle,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport {\n    CameraController as DefaultCameraController,\n    CameraControllerPresets,\n    CameraControllerPreset,\n} from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { ViewportContext } from \"./Viewport\";\n\n/**\n * Context that provides a camera controller.\n *\n * @category Contexts\n */\nexport const CameraControllerContext = createContext<{\n    cameraController: DefaultCameraController | undefined;\n}>({\n    cameraController: undefined,\n});\n\n/**\n * A component that provides a camera controller.\n *\n * @category Components\n */\nexport const CameraController = forwardRef(function CameraController(\n    { preset = CameraControllerPresets.orbital, children }: PropsWithChildren & { preset?: CameraControllerPreset },\n    ref: Ref<DefaultCameraController | undefined>,\n) {\n    const { viewport, camera } = useContext(ViewportContext);\n    const [cameraController, setCameraController] = useState<DefaultCameraController | undefined>(undefined);\n    useImperativeHandle(ref, () => cameraController, [cameraController]);\n\n    useEffect(() => {\n        if (!viewport || !camera) {\n            return;\n        }\n\n        const controller = new DefaultCameraController({\n            camera_entity: camera.camera_entity,\n            viewport,\n            preset,\n        });\n\n        setCameraController(controller);\n\n        return (): void => {\n            controller.release();\n            setCameraController(undefined);\n        };\n    }, [viewport, camera, preset]);\n\n    return <CameraControllerContext.Provider value={{ cameraController }}>{children}</CameraControllerContext.Provider>;\n});\n", "import React, { ReactNode, useContext, useEffect, useMemo, useState } from \"react\";\nimport { CanvasContext } from \"../core/Canvas\";\n\n/**\n * @experimental\n *\n * Recorder component for recording video from a canvas.\n *\n * @category Components\n */\nexport function Recorder({\n    fileOptions = {\n        description: \"Video recording\",\n        accept: {\n            \"video/webm\": [\".webm\"],\n        },\n    },\n    recorderOptions = {\n        mimeType: `video/webm; codecs=\"vp8\"`,\n        videoBitsPerSecond: 10000000,\n    },\n    streamOptions = {\n        frameRequestRate: 30,\n    },\n    children,\n}: {\n    fileOptions?: FilePickerAcceptType;\n    recorderOptions?: MediaRecorderOptions;\n    streamOptions?: { frameRequestRate: number };\n    children?: (props: { recordTime: number }) => ReactNode;\n}): ReactNode {\n    const { renderingSurface } = useContext(CanvasContext);\n    const [recordTime, setRecordTime] = useState(0);\n    const [isRecording, setIsRecording] = useState(false);\n\n    const mediaRecorder = useMemo(() => {\n        if (!renderingSurface) {\n            return null;\n        }\n\n        const stream = renderingSurface.canvas.captureStream(streamOptions.frameRequestRate);\n        return new MediaRecorder(stream, recorderOptions);\n    }, [renderingSurface]);\n\n    useEffect(() => {\n        if (!mediaRecorder) {\n            return;\n        }\n\n        window.showSaveFilePicker({ types: [fileOptions] }).then(async (fileHandle: FileSystemFileHandle) => {\n            const fileStream: FileSystemWritableFileStream = await fileHandle.createWritable();\n            mediaRecorder.ondataavailable = (event: BlobEvent): void => {\n                if (event.data.size > 0) {\n                    fileStream.write(event.data);\n                }\n            };\n            mediaRecorder.onstop = (): void => {\n                fileStream.close();\n            };\n            mediaRecorder.start();\n            setIsRecording(true);\n        });\n\n        return (): void => {\n            mediaRecorder.stop();\n        };\n    }, [mediaRecorder]);\n\n    useEffect(() => {\n        if (!isRecording) {\n            return;\n        }\n\n        const interval = setInterval(() => {\n            setRecordTime((prev: number) => prev + 1);\n        }, 1000);\n\n        return (): void => clearInterval(interval);\n    }, [isRecording]);\n\n    return <>{children ? children({ recordTime }) : null}</>;\n}\n", "export * from \"./hooks/useEntity\";\nexport * from \"./hooks/useClients\";\nexport * from \"./hooks/useCameraEntity\";\n\nexport * from \"./components/core/Livelink\";\nexport * from \"./components/core/Canvas\";\nexport * from \"./components/core/Viewport\";\nexport * from \"./components/core/CameraController\";\nexport * from \"./components/utils/Recorder\";\nexport { CameraController as DefaultCameraController } from \"@3dverse/livelink\";\n\nexport * from \"./components/overlays/DOM3DOverlay\";\nexport * from \"./components/overlays/DOM3DElement\";\nexport * from \"./components/overlays/DOMEntity\";\n\nexport * from \"./overlays/ReactOverlay\";\nexport * from \"./overlays/React3DElement\";\n\nexport * from \"./utils\";\n\n//------------------------------------------------------------------------------\n/**\n * Version of the Livelink React library, injected by the build system.\n * @internal\n */\ndeclare const LIVELINK_REACT_VERSION: string;\n\n/**\n * Name of the package, injected by the build system.\n * @internal\n */\ndeclare const PACKAGE_NAME: string;\n\n//------------------------------------------------------------------------------\ndeclare global {\n    interface Window {\n        __LIVELINK__: Record<string, string>;\n    }\n}\n\n//------------------------------------------------------------------------------\nif (typeof window !== \"undefined\") {\n    if (!window.__LIVELINK__) {\n        window.__LIVELINK__ = {};\n    }\n\n    if (Object.prototype.hasOwnProperty.call(window.__LIVELINK__, PACKAGE_NAME)) {\n        console.warn(\"\u26A0\uFE0F WARNING \u26A0\uFE0F Multiple instances of Livelink React \u269B\uFE0F being imported.\");\n    } else {\n        window.__LIVELINK__[PACKAGE_NAME] = LIVELINK_REACT_VERSION;\n    }\n}\n", "//------------------------------------------------------------------------------\nimport React, {\n    createContext,\n    HTMLProps,\n    JSX,\n    PropsWithChildren,\n    useContext,\n    useEffect,\n    useRef,\n    useState,\n} from \"react\";\n\n//------------------------------------------------------------------------------\nimport { ViewportContext } from \"../core/Viewport\";\nimport { ReactOverlay } from \"../../overlays/ReactOverlay\";\n\n/**\n * Context that provides an overlay.\n *\n * @category Contexts\n */\nexport const OverlayContext = createContext<ReactOverlay | null>(null);\n\n/**\n * A component that provides a DOM 3D overlay.\n *\n * @category Components\n */\nexport function DOM3DOverlay({ children, ...props }: PropsWithChildren<HTMLProps<HTMLDivElement>>): JSX.Element {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const [overlay, setOverlay] = useState<ReactOverlay | null>(null);\n    const { viewport } = useContext(ViewportContext);\n\n    useEffect(() => {\n        if (!viewport || !containerRef.current) {\n            return;\n        }\n\n        const overlay = new ReactOverlay({ container: containerRef.current, viewport });\n        viewport.addOverlay({ overlay });\n\n        setOverlay(overlay);\n\n        return (): void => {\n            viewport.removeOverlay({ overlay });\n        };\n    }, [viewport, containerRef]);\n\n    return (\n        <OverlayContext.Provider value={overlay}>\n            <div\n                ref={containerRef}\n                data-role=\"dom-3d-overlay\"\n                style={{\n                    position: \"absolute\",\n                    width: \"100%\",\n                    height: \"100%\",\n                    top: \"0\",\n                    pointerEvents: \"none\",\n                    padding: \"inherit\",\n                    overflow: \"hidden\",\n                }}\n                {...props}\n            >\n                {children}\n            </div>\n        </OverlayContext.Provider>\n    );\n}\n", "import React, { PropsWithChildren, ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { vec3 } from \"gl-matrix\";\nimport type { ReactOverlay, Projection } from \"./ReactOverlay\";\nimport { Vec2 } from \"@3dverse/livelink\";\n\n/**\n *\n */\nexport type Anchor =\n    | \"left-top\"\n    | \"left-center\"\n    | \"left-bottom\"\n    | \"center-top\"\n    | \"center\"\n    | \"center-bottom\"\n    | \"right-top\"\n    | \"right-center\"\n    | \"right-bottom\";\n\n/**\n *\n */\ntype HorizontalAnchor = \"left\" | \"center\" | \"right\";\n\n/**\n *\n */\ntype VerticalAnchor = \"top\" | \"center\" | \"bottom\";\n\n/**\n *\n */\nexport type React3DElementProps = PropsWithChildren<{\n    worldPosition: vec3;\n    anchor: Anchor;\n    scaleFactor?: number;\n}>;\n\n/**\n * @internal\n */\nexport function createReact3DElementFactory(overlay: ReactOverlay): (props: React3DElementProps) => React.ReactElement {\n    return (props: React3DElementProps): React.ReactElement => {\n        return <React3DElement overlay={overlay} {...props} />;\n    };\n}\n\n/**\n * @internal\n */\nexport class React3DElement extends React.Component<\n    { overlay: ReactOverlay } & React3DElementProps,\n    { screen_position: vec3; z_index: number; scale: number; is_visible: boolean; translation: Vec2 }\n> {\n    /**\n     *\n     */\n    static VerticalAnchorPositions: Record<VerticalAnchor, number> = {\n        top: 0,\n        center: -50,\n        bottom: -100,\n    };\n\n    /**\n     *\n     */\n    static HorizontalAnchorPositions: Record<HorizontalAnchor, number> = {\n        left: 0,\n        center: -50,\n        right: -100,\n    };\n\n    /**\n     *\n     */\n    state = {\n        screen_position: vec3.create(),\n        z_index: 0,\n        scale: 1,\n        is_visible: false,\n        translation: [0, 0] as Vec2,\n    };\n\n    /**\n     *\n     */\n    componentDidMount(): void {\n        this.#updateTranslation();\n        this.props.overlay._registerElement(this);\n    }\n\n    /**\n     *\n     */\n    componentDidUpdate(\n        prevProps: Readonly<\n            { overlay: ReactOverlay } & React3DElementProps & {\n                    children?: ReactNode | undefined;\n                }\n        >,\n    ): void {\n        if (\n            prevProps.worldPosition.some((v, i) => v !== this.props.worldPosition[i]) ||\n            prevProps.anchor !== this.props.anchor ||\n            prevProps.scaleFactor !== this.props.scaleFactor\n        ) {\n            this.#updateTranslation();\n            this.props.overlay._updateElement();\n        }\n    }\n\n    /**\n     *\n     */\n\n    /**\n     *\n     */\n    componentWillUnmount(): void {\n        this.props.overlay._unregisterElement(this);\n    }\n\n    /**\n     *\n     */\n    get screen_position(): vec3 {\n        return this.state.screen_position;\n    }\n\n    /**\n     *\n     */\n    get world_position(): vec3 {\n        return this.props.worldPosition;\n    }\n\n    /**\n     *\n     */\n    get scale_factor(): number | undefined {\n        return this.props.scaleFactor;\n    }\n\n    /**\n     *\n     */\n    setProjection(state: Projection & { z_index: number }): void {\n        this.setState(state);\n    }\n\n    /**\n     *\n     */\n    #updateTranslation(): void {\n        if (this.props.anchor === \"center\") {\n            this.setState({\n                translation: [\n                    React3DElement.HorizontalAnchorPositions.center,\n                    React3DElement.VerticalAnchorPositions.center,\n                ],\n            });\n            return;\n        }\n\n        const [anchor_x, anchor_y] = this.props.anchor.split(\"-\") as [HorizontalAnchor, VerticalAnchor];\n\n        this.setState({\n            translation: [\n                React3DElement.HorizontalAnchorPositions[anchor_x],\n                React3DElement.VerticalAnchorPositions[anchor_y],\n            ],\n        });\n    }\n\n    /**\n     *\n     */\n    render(): ReactNode {\n        if (!this.state.is_visible) {\n            return null;\n        }\n\n        const transformStyle = `\n            translate(${this.state.translation[0]}%, ${this.state.translation[1]}%)\n            translate(${this.state.screen_position[0]}px, ${this.state.screen_position[1]}px)`;\n\n        return createPortal(\n            <div\n                style={{\n                    position: \"absolute\",\n                    transform: transformStyle,\n                    zIndex: this.state.z_index,\n                    pointerEvents: \"auto\",\n                }}\n            >\n                {this.scale_factor ? (\n                    <div style={{ transform: `scale(${this.state.scale})` }}>{this.props.children}</div>\n                ) : (\n                    this.props.children\n                )}\n            </div>,\n            this.props.overlay.container,\n        );\n    }\n}\n", "/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};", "import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();", "//------------------------------------------------------------------------------\nimport React from \"react\";\n\n//------------------------------------------------------------------------------\nimport type { Vec3, OverlayInterface, Viewport } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { React3DElement, React3DElementProps, createReact3DElementFactory } from \"./React3DElement\";\n\n/**\n *\n */\nconst INFINITE_FAR_VALUE = 100000;\n\n/**\n *\n */\nexport type Projection = {\n    screen_position: Vec3;\n    scale: number;\n    is_visible: boolean;\n};\n\n/**\n *\n */\nexport class ReactOverlay implements OverlayInterface {\n    /**\n     *\n     */\n    readonly container: HTMLDivElement;\n\n    /**\n     *\n     */\n    readonly #elements: Set<React3DElement> = new Set();\n\n    /**\n     *\n     */\n    readonly #viewport: Viewport;\n\n    /**\n     *\n     */\n    readonly #factory: (props: React3DElementProps) => React.ReactElement;\n\n    /**\n     *\n     */\n    constructor({ container, viewport }: { container: HTMLDivElement; viewport: Viewport }) {\n        this.container = container;\n        this.#viewport = viewport;\n        this.#factory = createReact3DElementFactory(this);\n    }\n\n    /**\n     *\n     */\n    get DOM3DElement(): (props: React3DElementProps) => React.ReactElement {\n        return this.#factory;\n    }\n\n    /**\n     * @internal\n     */\n    _registerElement(react_element: React3DElement): void {\n        this.#elements.add(react_element);\n        this.#viewport.rendering_surface.redrawLastFrame();\n    }\n\n    /**\n     * @internal\n     */\n    _unregisterElement(react_element: React3DElement): void {\n        if (!this.#elements.delete(react_element)) {\n            console.warn(`Element ref not found in dom overlay`);\n        }\n    }\n\n    _updateElement(): void {\n        this.#viewport.rendering_surface.redrawLastFrame();\n    }\n\n    /**\n     *\n     */\n    resize({ width, height }: { width: number; height: number }): void {\n        this.container.style.width = width + \"px\";\n        this.container.style.height = height + \"px\";\n    }\n\n    /**\n     *\n     */\n    draw(): OffscreenCanvas | null {\n        if (!this.#viewport.isValid()) {\n            return null;\n        }\n\n        this.updateElements();\n        return null;\n    }\n\n    /**\n     *\n     */\n    updateElements(): void {\n        const elements: Array<{\n            projection: Projection;\n            react_element: React3DElement;\n        }> = [];\n\n        for (const react_element of this.#elements.values()) {\n            const projection = this.#projectElementOnScreen({ react_element });\n            elements.push({ projection, react_element });\n        }\n\n        elements.sort((a, b) => b.projection.screen_position[2] - a.projection.screen_position[2]);\n        elements.forEach(({ projection, react_element }, z_index) => {\n            react_element.setProjection({ ...projection, z_index });\n        });\n    }\n\n    /**\n     *\n     */\n    #projectElementOnScreen({ react_element }: { react_element: React3DElement }): Projection {\n        const screen_position = this.#viewport.projectWorldToScreen({\n            world_position: react_element.world_position as Vec3,\n            out_screen_position: react_element.screen_position as Vec3,\n        });\n\n        const scale = react_element.scale_factor\n            ? this.#computeElementScale({ screen_position, scale_factor: react_element.scale_factor })\n            : 1.0;\n\n        const is_visible = screen_position[2] < 1.0 && screen_position[2] > 0;\n\n        return {\n            screen_position,\n            scale,\n            is_visible,\n        };\n    }\n\n    /**\n     *\n     */\n    #computeElementScale({ screen_position, scale_factor }: { screen_position: Vec3; scale_factor: number }): number {\n        const camera = this.#viewport.camera_projection?.camera_entity;\n        if (!camera) {\n            throw new Error(\"Viewport has no camera\");\n        }\n\n        const near =\n            (camera.perspective_lens ? camera.perspective_lens.nearPlane : camera.orthographic_lens?.zFar) ?? 0;\n        const far =\n            (camera.perspective_lens\n                ? camera.perspective_lens.farPlane || INFINITE_FAR_VALUE\n                : camera.orthographic_lens?.zNear) ?? 1;\n\n        return (far - near) * (1 - screen_position[2]) * scale_factor;\n    }\n\n    /**\n     *\n     */\n    release(): void {\n        // We need to unmount the root in the next event loop\n        // iteration to avoid unmounting the root while rendering.\n        setTimeout(() => {\n            this.#elements.clear();\n        }, 0);\n    }\n}\n", "//------------------------------------------------------------------------------\nimport React, { PropsWithChildren, useContext } from \"react\";\nimport type { Vec3 } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { OverlayContext } from \"./DOM3DOverlay\";\nimport type { Anchor } from \"../../overlays/React3DElement\";\n\n/**\n * A component that renders a 3D DOM element.\n *\n * @category Components\n */\nexport function DOM3DElement({\n    worldPosition,\n    anchor = \"center\",\n    scaleFactor,\n    children,\n}: PropsWithChildren<{\n    worldPosition: Vec3;\n    anchor?: Anchor;\n    scaleFactor?: number;\n}>): React.JSX.Element | null {\n    const overlay = useContext(OverlayContext);\n    if (!overlay) {\n        return null;\n    }\n\n    return (\n        <overlay.DOM3DElement worldPosition={worldPosition} anchor={anchor} scaleFactor={scaleFactor}>\n            {children}\n        </overlay.DOM3DElement>\n    );\n}\n", "//------------------------------------------------------------------------------\nimport React, { JSX, PropsWithChildren, useEffect, useState } from \"react\";\n\n//------------------------------------------------------------------------------\nimport type { Entity, Vec3 } from \"@3dverse/livelink\";\n\n//------------------------------------------------------------------------------\nimport { DOM3DElement } from \"./DOM3DElement\";\nimport { Anchor } from \"../../overlays/React3DElement\";\n\n/**\n * A component that renders a DOM element at the position of an entity.\n *\n * @category Components\n */\nexport function DOMEntity({\n    entity,\n    scaleFactor,\n    anchor,\n    children,\n}: PropsWithChildren<{\n    entity: Entity | null;\n    anchor?: Anchor;\n    scaleFactor?: number;\n}>): JSX.Element | null {\n    const [worldPosition, setWorldPosition] = useState<Vec3>(entity ? entity.global_transform.position : [0, 0, 0]);\n    const [isVisible, setIsVisible] = useState(entity ? entity.is_visible : false);\n\n    useEffect(() => {\n        if (!entity) {\n            return;\n        }\n\n        const updatePosition = (): void => setWorldPosition(entity.global_transform.position);\n        const updateVisibility = (): void => setIsVisible(entity.is_visible);\n\n        // Initialize states\n        updatePosition();\n        updateVisibility();\n\n        entity.addEventListener(\"on-entity-updated\", updatePosition);\n        entity.addEventListener(\"on-entity-visibility-changed\", updateVisibility);\n        return (): void => {\n            entity.removeEventListener(\"on-entity-updated\", updatePosition);\n            entity.removeEventListener(\"on-entity-visibility-changed\", updateVisibility);\n        };\n    }, [entity]);\n\n    if (!entity || !isVisible) {\n        return null;\n    }\n\n    return (\n        <DOM3DElement worldPosition={worldPosition} anchor={anchor} scaleFactor={scaleFactor}>\n            {children}\n        </DOM3DElement>\n    );\n}\n"],
  "mappings": "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",
  "names": ["useContext", "useEffect", "useReducer", "useState", "React", "createContext", "useCallback", "useEffect", "useRef", "useState", "Livelink", "LivelinkInstance", "LivelinkContext", "LivelinkProvider", "sceneId", "sessionId", "isTransient", "token", "LoadingPanel", "InactivityWarningPanel", "ConnectionErrorPanel", "autoJoinExisting", "clientType", "children", "instance", "setInstance", "isConnecting", "setIsConnecting", "isConnectionLost", "setIsConnectionLost", "inactivityWarning", "setInactivityWarning", "connectionError", "setConnectionError", "connectionPromises", "disconnect", "connect", "session", "getOrCreateConnectionPromise", "params", "key", "getConnectionPromiseKey", "promise", "abort_controller", "onActivityDetected", "configureClient", "error", "onDisconnectedHandler", "event", "configure", "webcodec", "useEntity", "entityProvider", "watchedComponents", "instance", "useContext", "LivelinkContext", "entity", "setEntity", "useState", "isPending", "setIsPending", "forceUpdate", "useReducer", "x", "findEntityQuery", "useEffect", "foundEntity", "alwaysUpdate", "neverUpdate", "triggerUpdate", "event", "useContext", "useEffect", "useState", "useClients", "instance", "useContext", "LivelinkContext", "clients", "setClients", "useState", "useEffect", "onClientsChanged", "useCameraEntity", "props", "watchedComponents", "name", "position", "_orientation", "_eulerOrientation", "renderGraphRef", "settings", "renderTargetIndex", "_perspective_lens", "orientation", "eulerOrientation", "orthographic_lens", "perspective_lens", "isPending", "cameraEntity", "useEntity", "React", "createContext", "useContext", "useEffect", "useRef", "useState", "RenderingSurface", "CanvasContext", "createContext", "Canvas", "children", "contextType", "contextAttributes", "width", "height", "props", "instance", "useContext", "LivelinkContext", "parentCanvas", "renderingSurface", "setRenderingSurface", "useState", "canvasRef", "useRef", "useEffect", "rect", "surface", "RenderingSurface", "React", "computeCanvasContainerStyle", "React", "createContext", "forwardRef", "useCallback", "useContext", "useEffect", "useRef", "useState", "useImperativeHandle", "Livelink", "ViewportContext", "createContext", "Viewport", "forwardRef", "setHoveredEntity", "setPickedEntity", "renderTargetIndex", "children", "props", "ref", "cameraEntity", "client", "cameraIndex", "otherProps", "instance", "useContext", "LivelinkContext", "renderingSurface", "canvas", "CanvasContext", "parentZIndex", "viewport", "setViewport", "useState", "clientCameraEntity", "setClientCameraEntity", "camera", "setCamera", "viewportDomElement", "useRef", "useImperativeHandle", "onResize", "useCallback", "useEffect", "resizeObserver", "zIndex", "rect", "error", "cameraEntities", "onEntityPicked", "e", "onEntityHovered", "React", "React", "createContext", "forwardRef", "useContext", "useEffect", "useImperativeHandle", "useState", "DefaultCameraController", "CameraControllerPresets", "CameraControllerContext", "createContext", "CameraController", "forwardRef", "preset", "CameraControllerPresets", "children", "ref", "viewport", "camera", "useContext", "ViewportContext", "cameraController", "setCameraController", "useState", "useImperativeHandle", "useEffect", "controller", "DefaultCameraController", "React", "React", "useContext", "useEffect", "useMemo", "useState", "Recorder", "fileOptions", "recorderOptions", "streamOptions", "children", "renderingSurface", "useContext", "CanvasContext", "recordTime", "setRecordTime", "useState", "isRecording", "setIsRecording", "mediaRecorder", "useMemo", "stream", "useEffect", "fileHandle", "fileStream", "event", "interval", "prev", "React", "CameraController", "React", "createContext", "useContext", "useEffect", "useRef", "useState", "React", "createPortal", "EPSILON", "ARRAY_TYPE", "RANDOM", "degree", "y", "i", "vec3_exports", "__export", "add", "angle", "bezier", "ceil", "clone", "copy", "create", "cross", "dist", "distance", "div", "divide", "dot", "equals", "exactEquals", "floor", "forEach", "fromValues", "hermite", "inverse", "len", "length", "lerp", "max", "min", "mul", "multiply", "negate", "normalize", "random", "rotateX", "rotateY", "rotateZ", "round", "scale", "scaleAndAdd", "set", "sqrDist", "sqrLen", "squaredDistance", "squaredLength", "str", "sub", "subtract", "transformMat3", "transformMat4", "transformQuat", "zero", "create", "out", "ARRAY_TYPE", "clone", "a", "length", "x", "y", "z", "fromValues", "copy", "set", "add", "b", "subtract", "multiply", "divide", "ceil", "floor", "min", "max", "round", "scale", "scaleAndAdd", "distance", "squaredDistance", "squaredLength", "negate", "inverse", "normalize", "len", "dot", "cross", "ax", "ay", "az", "bx", "by", "bz", "lerp", "t", "hermite", "c", "d", "factorTimes2", "factor1", "factor2", "factor3", "factor4", "bezier", "inverseFactor", "inverseFactorTimesTwo", "random", "r", "RANDOM", "zScale", "transformMat4", "m", "w", "transformMat3", "transformQuat", "q", "qx", "qy", "qz", "qw", "uvx", "uvy", "uvz", "uuvx", "uuvy", "uuvz", "w2", "rotateX", "rad", "p", "rotateY", "rotateZ", "angle", "mag1", "mag2", "mag", "cosine", "zero", "str", "exactEquals", "equals", "a0", "a1", "a2", "b0", "b1", "b2", "EPSILON", "sub", "mul", "div", "dist", "sqrDist", "sqrLen", "forEach", "vec", "stride", "offset", "count", "fn", "arg", "i", "createReact3DElementFactory", "overlay", "props", "React", "React3DElement", "_React3DElement", "vec3_exports", "#updateTranslation", "prevProps", "v", "i", "state", "anchor_x", "anchor_y", "transformStyle", "createPortal", "INFINITE_FAR_VALUE", "ReactOverlay", "#elements", "#viewport", "#factory", "container", "viewport", "createReact3DElementFactory", "react_element", "width", "height", "elements", "projection", "#projectElementOnScreen", "a", "b", "z_index", "screen_position", "scale", "#computeElementScale", "is_visible", "scale_factor", "camera", "near", "OverlayContext", "createContext", "DOM3DOverlay", "children", "props", "containerRef", "useRef", "overlay", "setOverlay", "useState", "viewport", "useContext", "ViewportContext", "useEffect", "ReactOverlay", "React", "React", "useContext", "DOM3DElement", "worldPosition", "anchor", "scaleFactor", "children", "overlay", "useContext", "OverlayContext", "React", "React", "useEffect", "useState", "DOMEntity", "entity", "scaleFactor", "anchor", "children", "worldPosition", "setWorldPosition", "useState", "isVisible", "setIsVisible", "useEffect", "updatePosition", "updateVisibility", "React", "DOM3DElement"]
}
